<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSync - Sistema de Gesti贸n Acad茅mica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/base.css">
    <link rel="stylesheet" href="../styles/app.css">
    <link rel="stylesheet" href="../styles/components.css">
    <link rel="stylesheet" href="../styles/responsive.css">
    <link rel="stylesheet" href="../styles/scrollbar-fix.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="../styles/assets/icon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Mobile Navigation Overlay -->
    <div id="navOverlay" class="nav-overlay">
        <div class="nav-content">
            <div class="nav-header">
                <h2>EduSync</h2>
                <button id="closeNav" class="close-nav">&times;</button>
            </div>
            <nav class="mobile-nav">
                <a href="#dashboard" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span data-translate="dashboard">Panel de Control</span>
                </a>
                <a href="#student-management" class="nav-item" data-section="student-management">
                    <i class="fas fa-users"></i>
                    <span data-translate="student_management">Gesti贸n de Estudiantes</span>
                </a>
                <a href="#subjects-management" class="nav-item" data-section="subjects-management">
                   
                    <span data-translate="subjects_management">Gesti贸n de Materias</span>
                </a>
                <a href="#notifications" class="nav-item" data-section="notifications">
                    <i class="fas fa-bell"></i>
                    <span data-translate="notifications">Notificaciones</span>
                    <span class="notification-badge" id="notificationCount">0</span>
                </a>
                <a href="#reports" class="nav-item" data-section="reports">
                    <i class="fas fa-chart-bar"></i>
                    <span data-translate="reports">Reportes</span>
                </a>
                
                <!-- Language Selector in Navigation -->
                <div class="nav-language-selector">
                    <div class="nav-language-label">
                        <i class="fas fa-globe"></i>
                        <span data-translate="language">Idioma</span>
                    </div>
                    <select id="languageSelect" class="nav-language-dropdown">
                        <option value="es">Espa帽ol</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </nav>
        </div>
    </div>

    <!-- Desktop Navigation Header -->
    <header class="landing-header desktop-nav">
        <nav class="landing-nav">
            <div class="nav-brand">
                <img src="../styles/assets/icon.ico" alt="EduSync" style="width:50px;height:50px;">
                <span>EduSync</span>
            </div>
            <div class="nav-menu" id="desktopNavMenu">
                <a href="#dashboard" class="nav-link" data-section="dashboard">
                    <span data-translate="dashboard">Panel de Control</span>
                </a>
                <div class="nav-dropdown">
                    <a href="#student-management" class="nav-link dropdown-toggle" data-section="student-management">
                        <span data-translate="student_management">Gesti贸n de Estudiantes</span>
                        <i class="fas fa-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="#student-management" class="dropdown-item" data-section="student-management" data-subsection="students">
                            <i class="fas fa-users"></i>
                            <span data-translate="students">Estudiantes</span>
                        </a>
                        <a href="#student-management" class="dropdown-item" data-section="student-management" data-subsection="exams">
                            <i class="fas fa-file-alt"></i>
                            <span data-translate="exams">Ex谩menes</span>
                        </a>
                    </div>
                </div>
                    <a href="#subjects-management" class="nav-link" data-section="subjects-management">
                     
                        <span data-translate="subjects_management">Gesti贸n de Materias</span>
                    </a>
                <a href="#reports" class="nav-link" data-section="reports">
                    <span data-translate="reports">Reportes</span>
                </a>
                <a href="#notifications" class="nav-link notifications-icon" data-section="notifications" title="Notificaciones">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="desktopNotificationCount">0</span>
                </a>
                <div class="language-selector">
                    <button id="desktopLanguageToggle" class="language-toggle">
                        <i class="fas fa-globe"></i>
                        <span id="languageCode">ES</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div id="languageDropdown" class="language-dropdown-menu">
                        <div class="language-option" data-lang="es">
                            <span class="language-flag"></span>
                            <span class="language-name">Espa帽ol</span>
                        </div>
                        <div class="language-option" data-lang="en">
                            <span class="language-flag">吼</span>
                            <span class="language-name">English</span>
                        </div>
                    </div>
                    <select id="desktopLanguageSelect" class="language-dropdown" style="display: none;">
                        <option value="es">Espa帽ol</option>
                        <option value="en">English</option>
                    </select>
                </div>
                <div class="user-info">
                    <button id="desktopLogoutBtn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
            <div class="nav-toggle" id="desktopNavToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <div class="app-container">
        <!-- Mobile Header -->
        <header class="app-header mobile-header">
            <div class="header-left">
                <button id="menuToggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>EduSync</h1>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="welcomeUser" data-translate="welcome_user">隆Bienvenido, Usuario!</span>
                    <button id="logoutBtn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <!-- Hero Section -->
                <div class="dashboard-hero">
                    <div class="hero-content">
                        <h1 class="hero-title" data-translate="welcome_dashboard">Panel de Control</h1>
                        <p class="hero-subtitle" data-translate="welcome_subtitle">Gestiona tus clases, estudiantes y evaluaciones desde un solo lugar</p>
                        <div class="hero-actions">
                            <button class="hero-btn hero-btn-primary" id="quickCreateClassBtn">
                                <i class="fas fa-plus-circle"></i>
                                <span data-translate="create_class">Crear Clase</span>
                            </button>
                            <button class="hero-btn hero-btn-secondary" id="quickUploadMaterialBtn">
                                <i class="fas fa-upload"></i>
                                <span data-translate="upload_material">Subir Material</span>
                            </button>
                            <button class="hero-btn hero-btn-secondary" id="quickViewReportsBtn">
                                <i class="fas fa-chart-line"></i>
                                <span data-translate="view_reports">Ver Reportes</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- KPI Cards Section -->
                <div class="dashboard-kpis">
                    <div class="kpi-card kpi-students">
                        <div class="kpi-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="totalStudents">0</div>
                            <div class="kpi-label" data-translate="students">Estudiantes</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-attendance">
                        <div class="kpi-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="attendanceRate">0%</div>
                            <div class="kpi-label" data-translate="attendance_rate">Asistencia</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-tasks">
                        <div class="kpi-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="pendingTasks">0</div>
                            <div class="kpi-label" data-translate="pending_tasks">Tareas Pendientes</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-next-class">
                        <div class="kpi-icon">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="nextClassTime">--</div>
                            <div class="kpi-label" data-translate="next_class">Pr贸xima Clase</div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Grid -->
                <div class="dashboard-content-grid">
                    <!-- Left Column: Main Content -->
                    <div class="dashboard-main-column">
                        <!-- Quick Actions Section -->
                        <div class="dashboard-card quick-actions-card">
                            <h2 class="card-title" data-translate="quick_actions">Acciones R谩pidas</h2>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn" data-action="students">
                                    <i class="fas fa-user-plus"></i>
                                    <span data-translate="add_student">Agregar Estudiante</span>
                                </button>
                                <button class="quick-action-btn" data-action="attendance">
                                    <i class="fas fa-check-circle"></i>
                                    <span data-translate="mark_attendance">Marcar Asistencia</span>
                                </button>
                                <button class="quick-action-btn" data-action="grades">
                                    <i class="fas fa-graduation-cap"></i>
                                    <span data-translate="grade_students">Calificar</span>
                                </button>
                                <button class="quick-action-btn" data-action="subjects">
                                    <i class="fas fa-book"></i>
                                    <span data-translate="manage_subjects">Gestionar Materias</span>
                                </button>
                            </div>
                        </div>

                        <!-- Next Classes Section -->
                        <div class="dashboard-card next-classes-card">
                            <div class="card-header">
                                <h2 class="card-title" data-translate="upcoming_classes">Pr贸ximas Clases</h2>
                            </div>
                            <div class="classes-list" id="classesList">
                                <!-- Classes will be loaded dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Calendar Widget -->
                    <div class="dashboard-sidebar">
                        <div class="dashboard-card calendar-widget">
                            <div class="calendar-widget-header">
                                <h3 class="widget-title" data-translate="calendar">Calendario</h3>
                                <div class="calendar-widget-nav">
                                    <button id="prevMonth" class="widget-nav-btn" title="Mes anterior">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button id="nextMonth" class="widget-nav-btn" title="Mes siguiente">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="calendar-widget-month" id="currentMonth">Enero 2024</div>
                            <div class="calendar-widget-grid" id="calendarGrid">
                                <!-- Calendar will be generated by JavaScript -->
                            </div>
                            <div class="calendar-widget-footer">
                                <button class="calendar-view-full-btn" id="viewFullCalendarBtn">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span data-translate="view_full_calendar">Ver Calendario Completo</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Unified Student Management Section -->
            <section id="student-management" class="content-section">
                <div class="section-header">
                    
                    <div class="section-actions">
                        <div class="filters students-only">
                            <select id="unifiedSubjectFilter" class="filter-select">
                                <option value="" data-translate="all_subjects">Todas las Materias</option>
                                <!-- Options will be populated dynamically -->
                            </select>
                            <select id="unifiedCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="unifiedTopicFilter" class="filter-select">
                                <option value="" data-translate="all_topics">Todos los Temas</option>
                                <option value="COMPLETADO" data-translate="completed_topics">Temas Completados</option>
                                <option value="EN_PROGRESO" data-translate="in_progress_topics">Temas en Progreso</option>
                                <option value="PENDIENTE" data-translate="pending_topics">Temas Pendientes</option>
                            </select>
                        </div>
                        <div class="filters exams-only" style="display: none;">
                            <select id="examsSubjectFilter" class="filter-select">
                                <option value="" data-translate="all_subjects">Todas las Materias</option>
                                <!-- Options will be populated dynamically -->
                            </select>
                            <select id="examsCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="examsDateFilter" class="filter-select">
                                <option value="" data-translate="all_dates">Todas las Fechas</option>
                                <option value="today" data-translate="today">Hoy</option>
                                <option value="this_week" data-translate="this_week">Esta Semana</option>
                                <option value="this_month" data-translate="this_month">Este Mes</option>
                                <option value="upcoming" data-translate="upcoming">Pr贸ximos</option>
                                <option value="past" data-translate="past">Pasados</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button id="unifiedGridViewBtn" class="view-btn" data-view="grid" title="Vista de Tarjetas">
                                <i class="fas fa-th"></i>
                            </button>
                            <button id="unifiedListViewBtn" class="view-btn active" data-view="list" title="Vista de Lista">
                                <i class="fas fa-list"></i>
                            </button>
                            <button id="unifiedMatrixViewBtn" class="view-btn" data-view="matrix" title="Vista de Matriz: Alumnos por Materias">
                                <i class="fas fa-table"></i>
                            </button>
                        </div>
                        <div class="action-buttons" id="globalActionButtons">
                            <button id="addStudentBtn" class="btn-primary students-only">
                                <i class="fas fa-user-plus"></i>
                                <span data-translate="add_student">Agregar Estudiante</span>
                            </button>
                            <button id="markAttendanceBtn" class="btn-secondary students-only">
                                <i class="fas fa-calendar-check"></i>
                                <span data-translate="mark_attendance">Marcar Asistencia</span>
                            </button>
                            <button id="createExamBtn" class="btn-primary exams-only" style="display: none;">
                                <i class="fas fa-plus"></i>
                                <span data-translate="create_exam">Crear Examen</span>
                            </button>
                            <button id="gradeStudentsBtn" class="btn-secondary exams-only" style="display: none;">
                                <i class="fas fa-graduation-cap"></i>
                                <span data-translate="grade_students">Calificar Estudiantes</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Mobile Tab Navigation -->
                <div class="tab-navigation mobile-only">
                    <button id="studentsTab" class="tab-btn active" data-tab="students">
                        <i class="fas fa-users"></i>
                        <span data-translate="students">Estudiantes</span>
                    </button>
                    <button id="examsTab" class="tab-btn" data-tab="exams">
                        <i class="fas fa-file-alt"></i>
                        <span data-translate="exams">Ex谩menes</span>
                    </button>
                </div>

                <!-- Students Tab Content -->
                <div id="studentsTabContent" class="tab-content active">
                    <!-- Student Overview Cards -->
                    <div class="unified-student-cards" id="unifiedStudentCards" style="display: none;">
                        <!-- Student cards with integrated grades and attendance will be loaded dynamically -->
                    </div>

                    <!-- Detailed List View -->
                    <div class="unified-student-list" id="unifiedStudentList">
                        <!-- Detailed student information with grades and attendance will be loaded dynamically -->
                    </div>

                    <!-- Matrix View: Students by Subjects -->
                    <div class="unified-student-matrix" id="unifiedStudentMatrix" style="display: none;">
                        <!-- Cross-table: Students (rows) x Subjects (columns) will be loaded dynamically -->
                    </div>

                    <!-- Quick Stats for Selected Student -->
                    <div class="student-detail-panel" id="studentDetailPanel" style="display: none;">
                        <div class="panel-header">
                            <h3 id="selectedStudentName">Student Name</h3>
                            <button id="closeStudentDetail" class="btn-icon">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="panel-content">
                            <div class="student-stats">
                                <div class="stat-item">
                                    <span class="stat-label" data-translate="average_grade">Promedio:</span>
                                    <span class="stat-value" id="studentAverage">0%</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label" data-translate="attendance_rate">Asistencia:</span>
                                    <span class="stat-value" id="studentAttendance">0%</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label" data-translate="total_grades">Calificaciones:</span>
                                    <span class="stat-value" id="studentTotalGrades">0</span>
                                </div>
                            </div>
                            <div class="student-details">
                                <div class="detail-section">
                                    <h4 data-translate="recent_grades">Calificaciones Recientes</h4>
                                    <div id="studentRecentGrades" class="grades-list">
                                        <!-- Recent grades will be loaded here -->
                                    </div>
                                </div>
                                <div class="detail-section">
                                    <h4 data-translate="attendance_history">Historial de Asistencia</h4>
                                    <div id="studentAttendanceHistory" class="attendance-list">
                                        <!-- Attendance history will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exams Tab Content -->
                <div id="examsTabContent" class="tab-content">
                    <div class="exams-container" id="examsContainer" style="display: none;">
                        <!-- Exams will be loaded dynamically -->
                    </div>
                    <div class="exams-list" id="examsList">
                        <!-- Exams list view will be loaded dynamically -->
                    </div>
                </div>

                <!-- Exam Notes Tab Content -->
                <div id="examNotesTabContent" class="tab-content">
                    <div class="section-header">
                        
                        <div class="section-actions">
                            <button id="exportExamNotesBtn" class="btn-primary" style="display: none;">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_notes">Export Notes</span>
                            </button>
                            <button id="backToExamsBtn" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i>
                                <span data-translate="back_to_exams">Back to Exams</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Exam Info Summary -->
                    <div class="exam-info-summary" id="examInfoSummary">
                        <!-- Exam information will be loaded here -->
                    </div>
                    
                    <!-- Notes List -->
                    <div class="notes-list" id="notesList">
                        <!-- Notes table or empty state will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Attendance Section -->
            <section id="attendance" class="content-section">
                <div class="section-header">
                    
                    <div class="section-actions">
                        <button id="backAttendanceBtn" class="btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            <span data-translate="back">Volver</span>
                        </button>
                    </div>
                </div>

                <!-- Attendance View (for marking attendance) -->
                <div id="attendanceView" style="display: none;">
                    <div class="attendance-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="attendanceDate" data-translate="date">Fecha:</label>
                                <input type="date" id="attendanceDate" required>
                            </div>
                            <div class="form-group">
                                <label for="attendanceSubjectSelect" data-translate="subject">Materia:</label>
                                <select id="attendanceSubjectSelect" required>
                                    <option value="" data-translate="select_subject">- Seleccionar -</option>
                                    <!-- Materia options will be populated dynamically from logged-in user's materias -->
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="attendanceNotes" data-translate="notes">Observaciones:</label>
                            <textarea id="attendanceNotes" rows="3" placeholder="Notas adicionales..."></textarea>
                        </div>
                    </div>

                    <!-- Students Table for Attendance -->
                    <div class="attendance-table-container">
                        <table class="data-table attendance-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th data-translate="present">Presente</th>
                                    <th data-translate="absent">Ausente</th>
                                    <th data-translate="absences">Faltas</th>
                                    <th data-translate="status">Estado</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceTableBody">
                                <tr>
                                    <td colspan="6" class="text-center">Seleccione una materia para ver los estudiantes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="attendance-actions">
                        <button id="saveAttendanceBtn" class="btn-primary">
                            <i class="fas fa-save"></i>
                            <span data-translate="save_attendance">Guardar Asistencia</span>
                        </button>
                        <button id="cancelAttendanceBtn" class="btn-secondary">
                            <i class="fas fa-times"></i>
                            <span data-translate="cancel">Cancelar</span>
                        </button>
                    </div>
                </div>

                <!-- Attendance List (for viewing attendance records) -->
                <div id="attendanceList">
                    <!-- Attendance records will be loaded here -->
                </div>
            </section>

            <!-- Grade Marking Section -->
            <section id="grade-marking" class="content-section">
                <div class="section-header">
                  
                    <div class="section-actions">
                        <button id="backToStudentsBtn" class="btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            <span data-translate="back">Volver</span>
                        </button>
                    </div>
                </div>

                <!-- Grade Marking Form -->
                <div id="gradeMarkingView" style="display: none;">
                    <div class="grade-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gradeEvaluation" data-translate="evaluation">Evaluaci贸n:</label>
                                <select id="gradeEvaluation" required>
                                    <option value="" data-translate="select_evaluation">- Seleccionar Evaluaci贸n -</option>
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="gradeDate" data-translate="date">Fecha:</label>
                                <input type="date" id="gradeDate" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="gradeNotes" data-translate="notes">Observaciones:</label>
                            <textarea id="gradeNotes" rows="3" placeholder="Notas adicionales sobre la evaluaci贸n..."></textarea>
                        </div>
                    </div>

                    <!-- Students Table for Grade Marking -->
                    <div class="grade-table-container">
                        <table class="data-table grade-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th data-translate="grade">Calificaci贸n</th>
                                    <th data-translate="status">Estado</th>
                                    <th data-translate="actions">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="gradeTableBody">
                                <tr>
                                    <td colspan="5" class="text-center">Seleccione una evaluaci贸n para ver los estudiantes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="grade-actions">
                        <button id="saveGradesBtn" class="btn-primary">
                            <i class="fas fa-save"></i>
                            <span data-translate="save_grades">Guardar Calificaciones</span>
                        </button>
                        <button id="cancelGradesBtn" class="btn-secondary">
                            <i class="fas fa-times"></i>
                            <span data-translate="cancel">Cancelar</span>
                        </button>
                    </div>
                </div>

                <!-- Grade List (for viewing grade records) -->
                <div id="gradeMarkingList">
                    <!-- Grade records will be loaded here -->
                </div>
            </section>
            <!-- Reports Section -->
            <section id="reports" class="content-section">
               
                <div class="reports-container" id="reportsContainer">
                    <!-- Reports will be loaded dynamically -->
                </div>
            </section>
<!-- Notifications Section -->
<section id="notifications" class="content-section">
    <div class="notifications-header">
        <div class="notifications-title">
            <h2><i class="fas fa-bell"></i> Notifications</h2>
            <span class="notification-count" id="notificationCount">0</span>
        </div>
        <div class="notifications-controls">
            <div class="view-toggle">
                <button id="notificationsGridViewBtn" class="view-btn active" data-view="grid" title="Grid View">
                    <i class="fas fa-th"></i>
                </button>
                <button id="notificationsListViewBtn" class="view-btn" data-view="list" title="List View">
                    <i class="fas fa-list"></i>
                </button>
            </div>
            <button id="markAllReadBtn" class="btn btn-primary">
                <i class="fas fa-check-double"></i>
                <span data-translate="mark_all_read">Mark All Read</span>
            </button>
        </div>
    </div>
    
    <div class="notifications-content">
        <div class="notifications-grid" id="notificationsContainer">
            <!-- Notifications will be loaded dynamically -->
        </div>
        <div class="notifications-table" id="notificationsList" style="display: none;">
            <!-- Notifications list view will be loaded dynamically -->
        </div>
    </div>
</section>
            <!-- Subjects Management Section -->
            <section id="subjects-management" class="content-section">
                <div class="section-header">
                    
                    <div class="section-actions">
                        <div class="filters">
                            <select id="subjectsCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="subjectsStatusFilter" class="filter-select">
                                <option value="" data-translate="all_status">Todos los Estados</option>
                                <option value="ACTIVA" data-translate="active">Activa</option>
                                <option value="INACTIVA" data-translate="inactive">Inactiva</option>
                                <option value="FINALIZADA" data-translate="finished">Finalizada</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button id="subjectsGridViewBtn" class="view-btn" data-view="grid">
                                <i class="fas fa-th"></i>
                            </button>
                            <button id="subjectsListViewBtn" class="view-btn active" data-view="list">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                        <div class="action-buttons">
                            <button id="addSubjectBtn" class="btn-primary">
                                <i class="fas fa-plus"></i>
                                <span data-translate="add_subject">Agregar Materia</span>
                            </button>
                            <button id="exportSubjectsBtn" class="btn-secondary">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_subjects">Exportar</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Subjects Content -->
                <div class="subjects-container" id="subjectsContainer" style="display: none;">
                    <!-- Subject cards will be loaded dynamically -->
                </div>

                <!-- Detailed List View -->
                <div class="subjects-list" id="subjectsList">
                    <!-- Detailed subject information will be loaded dynamically -->
                </div>

                <!-- Subject Details View -->
                <div id="subjectDetailsView" class="subject-details-view" style="display: none;">
                    <div class="section-header">
                        <h2 id="subjectDetailsTitle">Detalles de la Materia</h2>
                        <div class="section-actions">
                            <button id="exportSubjectDetailsBtn" class="btn-primary" style="display: none;">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_details">Export Details</span>
                            </button>
                            <button id="backToSubjectsBtn" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i>
                                <span data-translate="back_to_subjects">Back to Subjects</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Subject Details Tab Navigation -->
                    <div class="subject-details-tabs">
                        <button id="subjectDetailsTab" class="tab-btn active" data-tab="details">
                            <i class="fas fa-info-circle"></i>
                            <span data-translate="details">Detalles</span>
                        </button>
                        <button id="subjectContentTab" class="tab-btn" data-tab="content">
                            <i class="fas fa-list"></i>
                            <span data-translate="content">Contenido</span>
                        </button>
                    </div>
                    
                    <!-- Subject Details Tab Content -->
                    <div id="subjectDetailsTabContent" class="tab-content active">
                        <!-- Subject Info Summary -->
                        <div class="subject-info-summary" id="subjectInfoSummary">
                            <!-- Subject information will be loaded here -->
                        </div>
                        
                        <!-- Subject Details Content -->
                        <div class="subject-details-content" id="subjectDetailsContent">
                            <!-- Subject statistics, students, evaluations, etc. will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Subject Content Tab Content -->
                    <div id="subjectContentTabContent" class="tab-content">
                        <div class="content-management">
                            <div class="content-header">
                                <h3 data-translate="subject_content">Contenido de la Materia</h3>
                                <button id="addContentBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i>
                                    <span data-translate="add_content">Agregar Contenido</span>
                                </button>
                            </div>
                            <div class="content-list-container" id="subjectContentList">
                                <!-- Content list will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            

            


        </main>
    </div>

    <!-- Footer (Desktop Only) -->
    <footer class="footer desktop-only">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <img src="../styles/assets/icon.ico" alt="EduSync" style="width:20px;height:20px;">
                    <span>EduSync</span>
                </div>
                <div class="footer-links">
                    <a href="#features" data-translate="features">Features</a>
                    <a href="#about" data-translate="about">About</a>
                    <a href="contact.html" data-translate="contact">Contact</a>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2024 EduSync. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-translate="add_edit_student">Agregar/Editar Estudiante</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="studentForm" class="modal-form">
                <div class="form-group">
                    <label for="studentFirstName" data-translate="first_name">Nombre</label>
                    <input type="text" id="studentFirstName" required>
                </div>
                <div class="form-group">
                    <label for="studentLastName" data-translate="last_name">Apellido</label>
                    <input type="text" id="studentLastName" required>
                </div>
                <div class="form-group">
                    <label for="studentEmail" data-translate="email">Correo Electr贸nico</label>
                    <input type="email" id="studentEmail" required>
                </div>
                <div class="form-group">
                    <label for="studentCourse" data-translate="course">Curso</label>
                    <select id="studentCourse" required>
                        <option value="9th" data-translate="9th_course">9潞 Curso</option>
                        <option value="10th" data-translate="10th_course">10潞 Curso</option>
                        <option value="11th" data-translate="11th_course">11潞 Curso</option>
                        <option value="12th" data-translate="12th_course">12潞 Curso</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="studentSubjects" data-translate="subjects">Materias</label>
                    <select id="studentSubjects" multiple size="5" style="min-height: 120px;">
                        <!-- Se poblar谩 din谩micamente con las materias del docente actual -->
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">Manten茅 presionada la tecla Ctrl (o Cmd en Mac) para seleccionar m煤ltiples materias</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="button" class="btn-primary" data-translate="save_student" onclick="saveStudent(); event.preventDefault(); return false;">Guardar Estudiante</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Subject Modal -->
    <div id="subjectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-translate="add_edit_subject">Agregar/Editar Materia</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="subjectForm" class="modal-form">
                <div class="form-group">
                    <label for="subjectName" data-translate="subject_name">Nombre de la Materia</label>
                    <input type="text" id="subjectName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="subjectCourse" data-translate="course">Curso</label>
                        <select id="subjectCourse" required>
                            <option value="" data-translate="select_course">- Seleccionar Curso -</option>
                            <option value="1">1潞 Curso</option>
                            <option value="2">2潞 Curso</option>
                            <option value="3">3潞 Curso</option>
                            <option value="4">4潞 Curso</option>
                            <option value="5">5潞 Curso</option>
                            <option value="6">6潞 Curso</option>
                            <option value="7">7潞 Curso</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="subjectDivision" data-translate="division">Divisi贸n</label>
                        <select id="subjectDivision" required>
                            <option value="" data-translate="select_division">- Seleccionar Divisi贸n -</option>
                            <option value="A">Divisi贸n A</option>
                            <option value="B">Divisi贸n B</option>
                            <option value="C">Divisi贸n C</option>
                            <option value="D">Divisi贸n D</option>
                            <option value="E">Divisi贸n E</option>
                            <option value="F">Divisi贸n F</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="subjectDescription" data-translate="description">Descripci贸n</label>
                    <textarea id="subjectDescription" rows="3" placeholder="Descripci贸n de la materia..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="subjectSchedule" data-translate="schedule">Horario</label>
                        <input type="text" id="subjectSchedule" placeholder="Ej: Lunes y Mi茅rcoles 10:00-12:00">
                    </div>
                    <div class="form-group">
                        <label for="subjectClassroom" data-translate="classroom">Aula</label>
                        <input type="text" id="subjectClassroom" placeholder="Ej: Aula 101">
                    </div>
                </div>
                <div class="form-group">
                    <label for="subjectTeacher" data-translate="teacher">Profesor</label>
                    <select id="subjectTeacher" required>
                        <option value="" data-translate="select_teacher">- Seleccionar Profesor -</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="subjectStatus" data-translate="status">Estado</label>
                    <select id="subjectStatus">
                        <option value="ACTIVA" data-translate="active">Activa</option>
                        <option value="INACTIVA" data-translate="inactive">Inactiva</option>
                        <option value="FINALIZADA" data-translate="finished">Finalizada</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="submit" class="btn-primary" data-translate="save_subject">Guardar Materia</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Content Edit Modal -->
    <div id="contentEditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-translate="edit_content">Editar Contenido</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="contentEditForm" class="modal-form">
                <div class="form-group">
                    <label for="editContentTopic" data-translate="content_topic">Tema del Contenido</label>
                    <input type="text" id="editContentTopic" required>
                </div>
                <div class="form-group">
                    <label for="editContentDescription" data-translate="description">Descripci贸n</label>
                    <textarea id="editContentDescription" rows="3" placeholder="Descripci贸n del contenido..."></textarea>
                </div>
                <div class="form-group">
                    <label for="editContentStatus" data-translate="status">Estado</label>
                    <select id="editContentStatus" required>
                        <option value="PENDIENTE" data-translate="pending">Pendiente</option>
                        <option value="EN_PROGRESO" data-translate="in_progress">En Progreso</option>
                        <option value="COMPLETADO" data-translate="completed">Completado</option>
                        <option value="CANCELADO" data-translate="cancelled">Cancelado</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="submit" class="btn-primary" data-translate="save_content">Guardar Contenido</button>
                </div>
            </form>
        </div>
    </div>

    <!-- No Subjects Warning Modal -->
    <div id="noSubjectsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle" style="color: #ffc107; margin-right: 10px;"></i> Materias Requeridas</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-form" style="padding: 20px;">
                <div class="form-group" style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 3rem; color: #ffc107; margin-bottom: 15px;">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <p style="font-size: 1.1rem; color: #333; line-height: 1.6; margin-bottom: 10px;">
                        No tienes materias creadas todav铆a.
                    </p>
                    <p style="color: #666; line-height: 1.6;">
                        Para agregar estudiantes, primero necesitas crear al menos una materia desde la secci贸n de <strong>"Gesti贸n de Materias"</strong>.
                    </p>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="button" class="btn-primary" id="goToSubjectsBtn">
                        <i class="fas fa-book"></i>
                        <span>Ir a Gesti贸n de Materias</span>
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- Script Modules -->
    <script src="../scripts/translations.js"></script>
    <script src="../scripts/utils.js"></script>
    <script src="../scripts/navigation.js"></script>
    <script src="../scripts/auth.js"></script>
    <script src="../scripts/dashboard.js"></script>
    <script src="../scripts/students.js"></script>
    <script src="../scripts/subjects.js"></script>
    <script src="../scripts/grades.js"></script>
    <script src="../scripts/attendance.js"></script>
    <script src="../scripts/unified-student-management.js"></script>
    <script src="../scripts/exams.js"></script>
    <script src="../scripts/notifications.js"></script>
    <!-- Load report components in order -->
    <script src="../scripts/reports/data-processor.js"></script>
    <script src="../scripts/reports/chart-manager.js"></script>
    <script src="../scripts/reports/report-generator.js"></script>
    <script src="../scripts/reports/export-manager.js"></script>
    <script src="../scripts/reports.js"></script>
    <script src="../scripts/reports/index.js"></script>
    <script src="../scripts/main.js"></script>
</body>
</html>
