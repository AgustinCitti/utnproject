<!DOCTYPE html>
<html lang="es">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSync - Sistema de Gesti贸n Acad茅mica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/base.css">
    <link rel="stylesheet" href="../styles/utilities.css">
    <link rel="stylesheet" href="../styles/app.css">
    <link rel="stylesheet" href="../styles/components.css">
    <link rel="stylesheet" href="../styles/responsive.css">
    <link rel="stylesheet" href="../styles/scrollbar-fix.css">
    <link rel="stylesheet" href="../styles/dark-mode.css">
    <link rel="stylesheet" href="../styles/components/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="../styles/assets/icon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            background-image: url('../styles/assets/background.jpeg');
            background-size: 200px 200px;
            background-position: top left;
            background-repeat: repeat;
        }
        
        /* Ensure navigation maintains white background */
        .landing-header,
        .desktop-nav,
        .landing-nav,
        .app-header,
        .mobile-header,
        .nav-overlay,
        .nav-content,
        .nav-header,
        .mobile-nav,
        .nav-menu,
        .nav-dropdown .dropdown-menu {
            background-color: white !important;
        }
        
        /* CSV Upload Area Styles */
        #bulkCsvUploadArea {
            min-height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        #bulkCsvUploadArea:hover {
            opacity: 0.8;
        }
        
        #bulkCsvUploadArea.drag-over {
            opacity: 0.9;
            transform: scale(1.02);
        }
        
        #bulkCsvFileInfo {
            width: 100%;
        }
        
        #bulkCsvPreview table {
            width: 100%;
            border-collapse: collapse;
        }
        
        #bulkCsvPreview table th {
            background: #f0f0f0;
            font-weight: 600;
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        #bulkCsvPreview table td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        
        #bulkCsvPreview table tr:nth-child(even) {
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <!-- ===================================================================
         NAVIGATION SECTION - Mobile and Desktop Navigation
         =================================================================== -->
    
    <!-- Mobile Navigation Overlay -->
    <div id="navOverlay" class="nav-overlay position-fixed top-0 left-0 w-full h-screen z-1000">
        <div class="nav-content position-absolute top-0 left-0 bg-white">
            <div class="nav-header d-flex justify-between items-center p-4">
                <h2 class="text-2xl font-bold text-primary">EduSync</h2>
                <button id="closeNav" class="close-nav">&times;</button>
            </div>
            <nav class="mobile-nav">
                <!-- Mobile Search Bar - Search Functionality in Mobile Nav -->
                <div class="p-4 mb-4 border-b border-gray">
                    <div class="d-flex items-center bg-white border border-gray rounded-lg p-2 gap-2 focus-within:border-primary focus-within:shadow-md transition-all">
                        <i class="fas fa-search text-secondary text-sm ml-1"></i>
                        <input type="text" id="mobileSearchInput" class="flex-1 border-none outline-none bg-transparent text-sm px-2 py-1 text-dark" placeholder="Buscar..." data-translate="search_placeholder">
                        <button id="mobileFiltersBtn" class="border-none bg-transparent cursor-pointer text-secondary hover:bg-light hover:text-primary transition-colors p-2 rounded" title="Filtros">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>
                <a href="#dashboard" class="d-flex items-center gap-3 px-4 py-3 text-dark no-underline transition-colors hover:bg-light hover:text-primary rounded-md" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span data-translate="dashboard">Panel de Control</span>
                </a>
                <a href="#student-management" class="d-flex items-center gap-3 px-4 py-3 text-dark no-underline transition-colors hover:bg-light hover:text-primary rounded-md" data-section="student-management">
                    <i class="fas fa-users"></i>
                    <span data-translate="student_management">Gesti贸n de Estudiantes</span>
                </a>
                <a href="#subjects-management" class="d-flex items-center gap-3 px-4 py-3 text-dark no-underline transition-colors hover:bg-light hover:text-primary rounded-md" data-section="subjects-management">
                    <i class="fas fa-book"></i>
                    <span data-translate="subjects_management">Gesti贸n de Materias</span>
                </a>
                <a href="#notifications" class="d-flex items-center gap-3 px-4 py-3 text-dark no-underline transition-colors hover:bg-light hover:text-primary rounded-md position-relative" data-section="notifications">
                    <i class="fas fa-bell"></i>
                    <span data-translate="notifications">Notificaciones</span>
                    <span class="notification-badge position-absolute top-0 right-0 bg-danger text-white rounded-full text-xs px-2 py-1 min-w-5 h-5 d-flex items-center justify-center font-bold" id="notificationCount">0</span>
                </a>
                <a href="#reports" class="d-flex items-center gap-3 px-4 py-3 text-dark no-underline transition-colors hover:bg-light hover:text-primary rounded-md" data-section="reports">
                    <i class="fas fa-chart-bar"></i>
                    <span data-translate="reports">Reportes</span>
                </a>
                
                <!-- Language Selector in Navigation - Mobile Language Switcher -->
                <div class="p-4 border-t border-gray mt-4">
                    <div class="d-flex items-center gap-2 mb-2">
                        <i class="fas fa-globe text-primary"></i>
                        <span class="text-sm font-medium text-dark" data-translate="language">Idioma</span>
                    </div>
                    <select id="languageSelect" class="w-full p-2 border border-gray rounded-md bg-white text-dark text-sm cursor-pointer">
                        <option value="es">Espa帽ol</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </nav>
        </div>
    </div>

    <!-- Desktop Navigation Header -->
    <header class="landing-header desktop-nav d-none w-full max-w-full">
        <nav class="landing-nav d-flex justify-between items-center px-8 py-4 max-w-7xl mx-auto w-full">
            <div class="nav-brand d-flex items-center gap-2 text-2xl font-bold text-primary">
                <img src="../styles/assets/icon.ico" alt="EduSync" style="width:50px;height:50px;">
                <span>EduSync</span>
            </div>
            
            <!-- Dark Mode Toggle Switch - Theme Switcher -->
            <div class="dark-mode-toggle-container">
                <label class="dark-mode-toggle" for="darkModeToggle">
                    <input type="checkbox" id="darkModeToggle" aria-label="Toggle dark mode">
                    <span class="toggle-slider"></span>
                    <i class="fas fa-moon toggle-icon"></i>
                </label>
            </div>
            
            <div class="nav-menu d-flex items-center gap-6" id="desktopNavMenu">
                <!-- Search Bar - Desktop Search Functionality -->
                <div class="position-relative mr-4 border">
                    <div class="d-flex items-center bg-white border border-gray rounded-lg p-2 gap-2 focus-within:border-primary focus-within:shadow-md transition-all">
                        <i class="fas fa-search text-secondary text-sm ml-1"></i>
                        <input type="text" id="desktopSearchInput" class="flex-1 border-none outline-none bg-transparent text-sm px-2 py-1 text-dark" placeholder="Buscar..." data-translate="search_placeholder">
                        <button id="desktopFiltersBtn" class="border-none bg-transparent cursor-pointer text-secondary hover:bg-light hover:text-primary transition-colors p-2 rounded" title="Filtros">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>
                <a href="#dashboard" class="nav-link d-flex items-center no-underline text-dark font-medium transition-colors px-4 py-2 rounded-md position-relative" data-section="dashboard">
                    <span data-translate="dashboard">Panel de Control</span>
                </a>
                <!-- Student Management Dropdown - Nested Navigation -->
                <div class="nav-dropdown">
                    <a href="#student-management" class="nav-link dropdown-toggle" data-section="student-management">
                        <span data-translate="student_management">Gesti贸n de Estudiantes</span>
                        <i class="fas fa-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="#student-management" class="dropdown-item" data-section="student-management" data-subsection="students">
                            <i class="fas fa-users"></i>
                            <span data-translate="students">Estudiantes</span>
                        </a>
                        <a href="#student-management" class="dropdown-item" data-section="student-management" data-subsection="exams">
                            <i class="fas fa-file-alt"></i>
                            <span data-translate="exams">Ex谩menes</span>
                        </a>
                    </div>
                </div>
                <!-- Subjects Management Link -->
                <a href="#subjects-management" class="nav-link" data-section="subjects-management">
                    <span data-translate="subjects_management">Gesti贸n de Materias</span>
                </a>
                <!-- Reports Link -->
                <a href="#reports" class="nav-link" data-section="reports">
                    <span data-translate="reports">Reportes</span>
                </a>
                <a href="#notifications" class="nav-link notifications-icon" data-section="notifications" title="Notificaciones">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="desktopNotificationCount">0</span>
                </a>
                <!-- Desktop Language Selector - Language Switcher -->
                <div class="language-selector">
                    <button id="desktopLanguageToggle" class="language-toggle">
                        <i class="fas fa-globe"></i>
                        <span id="languageCode">ES</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div id="languageDropdown" class="language-dropdown-menu">
                        <div class="language-option" data-lang="es">
                            <span class="language-flag"></span>
                            <span class="language-name">Espa帽ol</span>
                        </div>
                        <div class="language-option" data-lang="en">
                            <span class="language-flag">吼</span>
                            <span class="language-name">English</span>
                        </div>
                    </div>
                    <select id="desktopLanguageSelect" class="language-dropdown" style="display: none;">
                        <option value="es">Espa帽ol</option>
                        <option value="en">English</option>
                    </select>
                </div>
                <div class="user-info d-flex items-center gap-4">
                    <button id="desktopLogoutBtn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
            <div class="nav-toggle" id="desktopNavToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <!-- ===================================================================
         MAIN APPLICATION CONTAINER
         =================================================================== -->
    <div class="app-container min-h-screen d-flex flex-column">
        <!-- Mobile Header -->
        <header class="app-header mobile-header bg-white px-5 py-4 shadow-md d-flex justify-between items-center position-sticky top-0 z-100">
            <div class="header-left d-flex items-center gap-4">
                <button id="menuToggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="text-2xl font-semibold text-dark">EduSync</h1>
            </div>
            <div class="header-right d-flex items-center">
                <div class="user-info d-flex items-center gap-4">
                    <span id="welcomeUser" class="text-base font-medium text-dark" data-translate="welcome_user">隆Bienvenido, Usuario!</span>
                    <button id="logoutBtn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- ===================================================================
             MAIN CONTENT AREA - All Application Sections
             =================================================================== -->
        <main class="app-main flex-1 p-5 w-full max-w-full box-border">
            
            <!-- ===============================================================
                 DASHBOARD SECTION - Overview and Quick Actions
                 =============================================================== -->
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <!-- Hero Section - Welcome Banner -->
                <div class="dashboard-hero">
                    <div class="hero-content d-grid grid-cols-1 gap-8">
                        <h1 class="hero-title text-4xl font-bold text-center text-dark" data-translate="welcome_dashboard">Panel de Control</h1>
                        <p class="hero-subtitle text-xl text-center text-muted" data-translate="welcome_subtitle">Gestiona tus clases, estudiantes y evaluaciones desde un solo lugar</p>
                        <div class="hero-actions d-flex justify-center items-center gap-4 flex-wrap">
                            <button class="hero-btn hero-btn-primary" id="quickCreateClassBtn">
                                <i class="fas fa-plus-circle"></i>
                                <span data-translate="create_class">Crear Clase</span>
                            </button>
                            <button class="hero-btn hero-btn-secondary" id="quickUploadMaterialBtn">
                                <i class="fas fa-upload"></i>
                                <span data-translate="upload_material">Subir Material</span>
                            </button>
                            <button class="hero-btn hero-btn-secondary" id="quickViewReportsBtn">
                                <i class="fas fa-chart-line"></i>
                                <span data-translate="view_reports">Ver Reportes</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- KPI Cards Section - Key Performance Indicators -->
                <div class="dashboard-kpis d-grid grid-cols-4 grid-gap-4 mb-8">
                    <div class="kpi-card kpi-students d-flex items-center gap-4 p-6 bg-white rounded-xl shadow-lg">
                        <div class="kpi-icon d-flex items-center justify-center w-16 h-16 rounded-lg">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-content flex-1">
                            <div class="kpi-value text-4xl font-bold text-dark mb-2" id="totalStudents">0</div>
                            <div class="kpi-label text-sm font-medium text-muted uppercase" data-translate="students">Estudiantes</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-attendance d-flex items-center gap-4 p-6 bg-white rounded-xl shadow-lg">
                        <div class="kpi-icon d-flex items-center justify-center w-16 h-16 rounded-lg">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="kpi-content flex-1">
                            <div class="kpi-value text-4xl font-bold text-dark mb-2" id="attendanceRate">0%</div>
                            <div class="kpi-label text-sm font-medium text-muted uppercase" data-translate="attendance_rate">Asistencia</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-tasks d-flex items-center gap-4 p-6 bg-white rounded-xl shadow-lg">
                        <div class="kpi-icon d-flex items-center justify-center w-16 h-16 rounded-lg">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="kpi-content flex-1">
                            <div class="kpi-value text-4xl font-bold text-dark mb-2" id="pendingTasks">0</div>
                            <div class="kpi-label text-sm font-medium text-muted uppercase" data-translate="pending_tasks">Tareas Pendientes</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-next-class d-flex items-center gap-4 p-6 bg-white rounded-xl shadow-lg">
                        <div class="kpi-icon d-flex items-center justify-center w-16 h-16 rounded-lg">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="kpi-content flex-1">
                            <div class="kpi-value text-4xl font-bold text-dark mb-2" id="nextClassTime">--</div>
                            <div class="kpi-label text-sm font-medium text-muted uppercase" data-translate="next_class">Pr贸xima Clase</div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Grid - Dashboard Layout -->
                <div class="dashboard-content-grid d-grid w-full max-w-full mb-8" style="grid-template-columns: 1fr 380px; gap: 2rem;">
                    <!-- Left Column: Main Content -->
                    <div class="dashboard-main-column d-flex flex-column gap-8">
                        <!-- Quick Actions Section - Common Action Buttons -->
                        <div class="dashboard-card quick-actions-card bg-white rounded-2xl p-8 shadow-lg border box-border w-full">
                            <h2 class="card-title text-2xl font-semibold text-dark mb-6" data-translate="quick_actions">Acciones R谩pidas</h2>
                            <div class="quick-actions-grid d-grid grid-cols-2 gap-4">
                                <button class="quick-action-btn" data-action="students" data-modal="studentModal">
                                    <i class="fas fa-user-plus"></i>
                                    <span data-translate="add_student">Agregar Estudiante</span>
                                </button>
                                <button class="quick-action-btn" data-action="attendance">
                                    <i class="fas fa-check-circle"></i>
                                    <span data-translate="mark_attendance">Marcar Asistencia</span>
                                </button>
                                <button class="quick-action-btn" data-action="grades">
                                    <i class="fas fa-graduation-cap"></i>
                                    <span data-translate="grade_students">Calificar</span>
                                </button>
                                <button class="quick-action-btn" data-action="subjects" data-modal="subjectModal">
                                    <i class="fas fa-book"></i>
                                    <span data-translate="add_subject">Agregar Materia</span>
                                </button>
                            </div>
                        </div>

                        <!-- Unified Notifications and Classes Section - Combined View -->
                        <div class="dashboard-card next-classes-card bg-white rounded-2xl p-8 shadow-lg border box-border w-full">
                            <div class="card-header d-flex justify-between items-center mb-6">
                                <h2 class="card-title text-2xl font-semibold text-dark mb-0" data-translate="notifications_and_classes">Notificaciones y Pr贸ximas Clases</h2>
                            </div>
                            <div class="classes-list d-flex flex-column gap-4" id="unifiedNotificationsList">
                                <!-- Unified notifications, recordatorios, and upcoming classes will be loaded dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Calendar Widget - Mini Calendar View -->
                    <div class="dashboard-sidebar d-flex flex-column gap-8">
                        <div class="dashboard-card calendar-widget bg-white rounded-2xl p-8 shadow-lg border box-border w-full">
                            <div class="calendar-widget-header d-flex justify-between items-center mb-4">
                                <h3 class="widget-title text-xl font-semibold text-dark" data-translate="calendar">Calendario</h3>
                                <div class="calendar-widget-nav d-flex gap-2">
                                    <button id="prevMonth" class="widget-nav-btn" title="Mes anterior">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button id="nextMonth" class="widget-nav-btn" title="Mes siguiente">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="calendar-widget-month" id="currentMonth">Enero 2024</div>
                            <div class="calendar-widget-grid" id="calendarGrid">
                                <!-- Calendar will be generated by JavaScript -->
                            </div>
                            <div class="calendar-widget-footer">
                                <button class="calendar-view-full-btn" id="viewFullCalendarBtn">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span data-translate="view_full_calendar">Ver Calendario Completo</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===============================================================
                 STUDENT MANAGEMENT SECTION - Students and Exams Management
                 =============================================================== -->
            <!-- Unified Student Management Section -->
            <section id="student-management" class="content-section">
                <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                    <h2 class="text-3xl font-semibold text-dark">Gesti贸n de Estudiantes</h2>
                    <div class="section-actions d-flex gap-4">
                        <div class="filters students-only">
                            <select id="unifiedSubjectFilter" class="filter-select">
                                <option value="" data-translate="all_subjects">Todas las Materias</option>
                                <!-- Options will be populated dynamically -->
                            </select>
                            <select id="unifiedCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="unifiedTopicFilter" class="filter-select">
                                <option value="" data-translate="all_topics">Todos los Temas</option>
                                <option value="COMPLETADO" data-translate="completed_topics">Temas Completados</option>
                                <option value="EN_PROGRESO" data-translate="in_progress_topics">Temas en Progreso</option>
                                <option value="PENDIENTE" data-translate="pending_topics">Temas Pendientes</option>
                            </select>
                        </div>
                        <div class="filters exams-only" style="display: none;">
                            <select id="examsSubjectFilter" class="filter-select">
                                <option value="" data-translate="all_subjects">Todas las Materias</option>
                                <!-- Options will be populated dynamically -->
                            </select>
                            <select id="examsCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="examsDateFilter" class="filter-select">
                                <option value="" data-translate="all_dates">Todas las Fechas</option>
                                <option value="today" data-translate="today">Hoy</option>
                                <option value="this_week" data-translate="this_week">Esta Semana</option>
                                <option value="this_month" data-translate="this_month">Este Mes</option>
                                <option value="upcoming" data-translate="upcoming">Pr贸ximos</option>
                                <option value="past" data-translate="past">Pasados</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button id="unifiedGridViewBtn" class="view-btn" data-view="grid" title="Vista de Tarjetas">
                                <i class="fas fa-th"></i>
                            </button>
                            <button id="unifiedListViewBtn" class="view-btn active" data-view="list" title="Vista de Lista">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                        <div class="action-buttons" id="globalActionButtons">
                            <button id="addStudentBtn" class="btn-primary students-only">
                                <i class="fas fa-user-plus"></i>
                                <span data-translate="add_student">Agregar Estudiante</span>
                            </button>
                            <button id="loadCourseDivisionBtn" class="btn-secondary students-only">
                                <i class="fas fa-users-cog"></i>
                                <span>Cargar Curso/Divisi贸n</span>
                            </button>
                            <button id="markAttendanceBtn" class="btn-secondary students-only">
                                <i class="fas fa-calendar-check"></i>
                                <span data-translate="mark_attendance">Marcar Asistencia</span>
                            </button>
                            <button id="createExamBtn" class="btn-primary exams-only" style="display: none;">
                                <i class="fas fa-plus"></i>
                                <span data-translate="create_exam">Crear Examen</span>
                            </button>
                            <button id="exportListBtn" class="btn-secondary">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_list">Exportar Lista</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Mobile Tab Navigation -->
                <div class="tab-navigation mobile-only">
                    <button id="studentsTab" class="tab-btn active" data-tab="students">
                        <i class="fas fa-users"></i>
                        <span data-translate="students">Estudiantes</span>
                    </button>
                    <button id="examsTab" class="tab-btn" data-tab="exams">
                        <i class="fas fa-file-alt"></i>
                        <span data-translate="exams">Ex谩menes</span>
                    </button>
                </div>

                <!-- Students Tab Content - Main Student Management Interface -->
                <div id="studentsTabContent" class="tab-content active">
                    <!-- Student Overview Cards - Grid View of Students -->
                    <div class="unified-student-cards" id="unifiedStudentCards" style="display: none;">
                        <!-- Student cards with integrated grades and attendance will be loaded dynamically -->
                    </div>

                    <!-- Detailed List View - Tabular Student Data -->
                    <div class="unified-student-list" id="unifiedStudentList">
                        <!-- Detailed student information with grades and attendance will be loaded dynamically -->
                    </div>

                    <!-- Matrix View: Students by Subjects - Cross-Reference Table -->
                    <div class="unified-student-matrix" id="unifiedStudentMatrix" style="display: none;">
                        <!-- Cross-table: Students (rows) x Subjects (columns) will be loaded dynamically -->
                    </div>

                    <!-- Quick Stats for Selected Student - Detail Panel -->
                    <div class="student-detail-panel" id="studentDetailPanel" style="display: none;">
                        <div class="panel-header">
                            <h3 id="selectedStudentName">Student Name</h3>
                            <button id="closeStudentDetail" class="btn-icon">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="panel-content">
                            <!-- Porcentaje de Asistencias -->
                            <div style="padding: 15px 0; border-bottom: 1px solid #e0e0e0;">
                                <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Asistencia</div>
                                <div id="studentAttendance" style="font-size: 1.8em; font-weight: 700; color: #667eea;">0%</div>
                            </div>
                            
                            <!-- Secci贸n de Calificaciones o Temas de Intensificaci贸n -->
                            <div style="padding: 15px 0;">
                                <div id="studentGradesTitle" style="font-size: 0.9em; color: #666; margin-bottom: 15px; font-weight: 600;">Calificaciones</div>
                                <div id="studentRecentGrades" style="display: flex; flex-direction: column; gap: 12px;">
                                    <!-- Calificaciones o Temas de Intensificaci贸n will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exams Tab Content - Exam Management Interface -->
                <div id="examsTabContent" class="tab-content">
                    <div class="exams-container" id="examsContainer" style="display: none;">
                        <!-- Exams will be loaded dynamically -->
                    </div>
                    <div class="exams-list" id="examsList">
                        <!-- Exams list view will be loaded dynamically -->
                    </div>
                </div>

                <!-- Exam Notes Tab Content - View and Manage Exam Grades -->
                <div id="examNotesTabContent" class="tab-content">
                    <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                        <h2 class="text-3xl font-semibold text-dark">Notas del Examen</h2>
                        <div class="section-actions d-flex gap-4">
                            <button id="exportExamNotesBtn" class="btn-primary" style="display: none;">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_notes">Export Notes</span>
                            </button>
                            <button id="backToExamsBtn" class="btn-secondary" onclick="if(typeof backToExams === 'function') { backToExams(); } else if(typeof window.backToExams === 'function') { window.backToExams(); }">
                                <i class="fas fa-arrow-left"></i>
                                <span data-translate="back_to_exams">Back to Exams</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Exam Info Summary - Exam Details Display -->
                    <div class="exam-info-summary" id="examInfoSummary">
                        <!-- Exam information will be loaded here -->
                    </div>
                    
                    <!-- Notes List - Student Grades Table -->
                    <div class="notes-list" id="notesList">
                        <!-- Notes table or empty state will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- ===============================================================
                 ATTENDANCE SECTION - Mark and View Student Attendance
                 =============================================================== -->
            <!-- Attendance Section -->
            <section id="attendance" class="content-section">
                <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                    <h2 class="text-3xl font-semibold text-dark">Asistencia</h2>
                    <div class="section-actions d-flex gap-4">
                        <button id="backAttendanceBtn" class="btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            <span data-translate="back">Volver</span>
                        </button>
                    </div>
                </div>

                <!-- Attendance View - Form for Marking Attendance -->
                <div id="attendanceView" style="display: none;">
                    <!-- Attendance Form - Date, Subject, and Notes Selection -->
                    <div class="attendance-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="attendanceDate" data-translate="date">Fecha:</label>
                                <input type="date" id="attendanceDate" required>
                            </div>
                            <div class="form-group">
                                <label for="attendanceSubjectSelect" data-translate="subject">Materia:</label>
                                <select id="attendanceSubjectSelect" required>
                                    <option value="" data-translate="select_subject">- Seleccionar -</option>
                                    <!-- Materia options will be populated dynamically from logged-in user's materias -->
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="attendanceNotes" data-translate="notes">Observaciones:</label>
                            <textarea id="attendanceNotes" rows="3" placeholder="Notas adicionales..."></textarea>
                        </div>
                    </div>

                    <!-- Students Table for Attendance - Attendance Entry Table -->
                    <div class="attendance-table-container">
                        <table class="data-table attendance-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th data-translate="present">Presente</th>
                                    <th data-translate="absent">Ausente</th>
                                    <th data-translate="absences">Faltas</th>
                                    <th data-translate="status">Estado</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceTableBody">
                                <tr>
                                    <td colspan="6" class="text-center">Seleccione una materia para ver los estudiantes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="attendance-actions">
                        <button id="saveAttendanceBtn" class="btn-primary">
                            <i class="fas fa-save"></i>
                            <span data-translate="save_attendance">Guardar Asistencia</span>
                        </button>
                        <button id="cancelAttendanceBtn" class="btn-secondary">
                            <i class="fas fa-times"></i>
                            <span data-translate="cancel">Cancelar</span>
                        </button>
                    </div>
                    </div>

                    <!-- Attendance List - Historical Attendance Records -->
                <div id="attendanceList">
                    <!-- Attendance records will be loaded here -->
                </div>
            </section>

            <!-- ===============================================================
                 GRADE MARKING SECTION - Mark and View Student Grades
                 =============================================================== -->
            <!-- Grade Marking Section -->
            <section id="grade-marking" class="content-section">
                <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                    <h2 class="text-3xl font-semibold text-dark">Calificaciones</h2>
                    <div class="section-actions d-flex gap-4">
                        <button id="backToStudentsBtn" class="btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            <span data-translate="back">Volver</span>
                        </button>
                    </div>
                </div>

                <!-- Grade Marking Form - Form for Entering Grades -->
                <div id="gradeMarkingView" style="display: none;">
                    <!-- Grade Form - Evaluation, Date, and Notes Selection -->
                    <div class="grade-form">
                        <div class="form-row">
                            <!-- Evaluation selector is hidden - automatically selected -->
                            <div class="form-group" style="display: none;">
                                <label for="gradeEvaluation" data-translate="evaluation">Evaluaci贸n:</label>
                                <select id="gradeEvaluation" required>
                                    <option value="" data-translate="select_evaluation">- Seleccionar Evaluaci贸n -</option>
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="gradeDate" data-translate="date">Fecha:</label>
                                <input type="date" id="gradeDate" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="gradeNotes" data-translate="notes">Observaciones:</label>
                            <textarea id="gradeNotes" rows="3" placeholder="Notas adicionales sobre la evaluaci贸n..."></textarea>
                        </div>
                    </div>

                    <!-- Students Table for Grade Marking - Grade Entry Table -->
                    <div class="grade-table-container">
                        <table class="data-table grade-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th data-translate="grade">Calificaci贸n</th>
                                    <th>Observaciones</th>
                                    <th data-translate="status">Estado</th>
                                </tr>
                            </thead>
                            <tbody id="gradeTableBody">
                                <tr>
                                    <td colspan="5" class="text-center">Seleccione una evaluaci贸n para ver los estudiantes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="grade-actions">
                        <button id="saveGradesBtn" class="btn-primary">
                            <i class="fas fa-save"></i>
                            <span data-translate="save_grades">Guardar Calificaciones</span>
                        </button>
                        <button id="cancelGradesBtn" class="btn-secondary">
                            <i class="fas fa-times"></i>
                            <span data-translate="cancel">Cancelar</span>
                        </button>
                    </div>
                    </div>

                <!-- Grade List - Historical Grade Records -->
                <div id="gradeMarkingList">
                    <!-- Grade records will be loaded here -->
                </div>
            </section>
            
            <!-- ===============================================================
                 REPORTS SECTION - Generate and View Academic Reports
                 =============================================================== -->
            <!-- Reports Section -->
            <section id="reports" class="content-section">
               
                <div class="reports-container" id="reportsContainer">
                    <!-- Reports will be loaded dynamically -->
                </div>
            </section>
            
            <!-- ===============================================================
                 NOTIFICATIONS SECTION - View and Manage Notifications
                 =============================================================== -->
            <!-- Notifications Section -->
<section id="notifications" class="content-section">
    <div class="notifications-header">
        <div class="notifications-title">
            <h2><i class="fas fa-bell"></i> <span data-translate="notifications">Notificaciones</span></h2>
            <span class="notification-count" id="notificationCount">0</span>
        </div>
        <div class="notifications-controls">
            <div class="view-toggle">
                <button id="notificationsGridViewBtn" class="view-btn active" data-view="grid" title="Grid View">
                    <i class="fas fa-th"></i>
                </button>
                <button id="notificationsListViewBtn" class="view-btn" data-view="list" title="List View">
                    <i class="fas fa-list"></i>
                </button>
            </div>
            <button id="markAllReadBtn" class="btn btn-primary">
                <i class="fas fa-check-double"></i>
                <span data-translate="mark_all_read">Mark All Read</span>
            </button>
        </div>
    </div>
    
    <div class="notifications-content">
        <div class="notifications-grid" id="notificationsContainer" style="display: grid; gap: 1rem; padding: 1rem;">
            <!-- Notifications will be loaded dynamically -->
        </div>
                        <div class="notifications-table" id="notificationsList" style="display: none;">
            <table class="data-table">
                <thead>
                    <tr>
                        <th data-translate="notification_type">Tipo</th>
                        <th data-translate="notification_title">T铆tulo</th>
                        <th data-translate="notification_message">Descripci贸n</th>
                        <th data-translate="notification_date">Fecha</th>
                        <th>Prioridad</th>
                        <th data-translate="notification_status">Estado</th>
                        <th>Fecha Creaci贸n</th>
                        <th data-translate="notification_actions">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Notifications list view will be loaded dynamically -->
                </tbody>
            </table>
        </div>
    </div>
</section>
            
            <!-- ===============================================================
                 CALENDAR SECTION - View Academic Calendar and Events
                 =============================================================== -->
            <!-- Calendar Section -->
            <section id="calendar" class="content-section">
                <div class="calendar-header">
                    <div class="calendar-title-section">
                        <h2 class="calendar-title" data-translate="calendar">Calendario</h2>
                    </div>
                    <div class="calendar-controls">
                        <div class="view-toggle">
                            <button id="calendarWeekBtn" class="view-btn active" data-view="week">
                                <span data-translate="week">Semana</span>
                            </button>
                            <button id="calendarMonthBtn" class="view-btn" data-view="month">
                                <span data-translate="month">Mes</span>
                            </button>
                        </div>
                        <div class="date-navigation">
                            <button id="calendarPrevBtn" class="nav-btn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div class="current-date-range" id="currentDateRange">
                                Jan 8, 2024 - Jan 14, 2024
                            </div>
                            <button id="calendarNextBtn" class="nav-btn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="calendar-actions">
                            <button id="calendarTodayBtn" class="action-btn">
                                <i class="fas fa-calendar-day"></i>
                                <span data-translate="today">Hoy</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Week View - Weekly Calendar Display -->
                <div id="calendarWeekView" class="calendar-week-view">
                    <div class="calendar-time-column">
                        <div class="time-header"></div>
                        <div class="time-slots" id="timeSlots"></div>
                    </div>
                    <div class="calendar-days-container">
                        <div class="calendar-days-header" id="calendarDaysHeader"></div>
                        <div class="calendar-days-grid" id="calendarDaysGrid"></div>
                    </div>
                </div>
                
                <!-- Month View - Monthly Calendar Display -->
                <div id="calendarMonthView" class="calendar-month-view" style="display: none;">
                    <div class="calendar-month-grid" id="calendarMonthGrid"></div>
                </div>
            </section>

            <!-- ===============================================================
                 SUBJECTS MANAGEMENT SECTION - Manage Academic Subjects
                 =============================================================== -->
            <!-- Subjects Management Section -->
            <section id="subjects-management" class="content-section">
                <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                    <h2 class="text-3xl font-semibold text-dark">Gesti贸n de Materias</h2>
                    <div class="section-actions d-flex gap-4">
                        <div class="filters">
                            <select id="subjectsCourseFilter" class="filter-select">
                                <option value="" data-translate="all_courses">Todos los Cursos</option>
                                <!-- Options will be populated dynamically based on user's subjects -->
                            </select>
                            <select id="subjectsStatusFilter" class="filter-select">
                                <option value="" data-translate="all_status">Todos los Estados</option>
                                <option value="ACTIVA" data-translate="active">Activa</option>
                                <option value="INACTIVA" data-translate="inactive">Inactiva</option>
                                <option value="FINALIZADA" data-translate="finished">Finalizada</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button id="subjectsGridViewBtn" class="view-btn" data-view="grid">
                                <i class="fas fa-th"></i>
                            </button>
                            <button id="subjectsListViewBtn" class="view-btn active" data-view="list">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                        <div class="action-buttons">
                            <button id="addSubjectBtn" class="btn-primary">
                                <i class="fas fa-plus"></i>
                                <span data-translate="add_subject">Agregar Materia</span>
                            </button>
                            <button id="exportSubjectsBtn" class="btn-secondary">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_subjects">Exportar</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Subjects Content - Grid and List Views -->
                <div class="subjects-container" id="subjectsContainer" style="display: none;">
                    <!-- Subject cards will be loaded dynamically -->
                </div>

                <!-- Detailed List View -->
                <div class="subjects-list" id="subjectsList">
                    <!-- Detailed subject information will be loaded dynamically -->
                </div>

                <!-- Subject Details View - Detailed Subject Information -->
                <div id="subjectDetailsView" class="subject-details-view" style="display: none;">
                    <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                        <h2 id="subjectDetailsTitle" class="text-3xl font-semibold text-dark">Detalles de la Materia</h2>
                        <div class="section-actions d-flex gap-4">
                            <button id="exportSubjectDetailsBtn" class="btn-primary" style="display: none;">
                                <i class="fas fa-download"></i>
                                <span data-translate="export_details">Export Details</span>
                            </button>
                            <button id="backToSubjectsBtn" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i>
                                <span data-translate="back_to_subjects">Back to Subjects</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Subject Details Tab Navigation - Details and Content Tabs -->
                    <div class="subject-details-tabs">
                        <button id="subjectDetailsTab" class="tab-btn active" data-tab="details">
                            <i class="fas fa-info-circle"></i>
                            <span data-translate="details">Detalles</span>
                        </button>
                        <button id="subjectContentTab" class="tab-btn" data-tab="content">
                            <i class="fas fa-list"></i>
                            <span data-translate="content">Contenido</span>
                        </button>
                    </div>
                    
                    <!-- Subject Details Tab Content - Subject Information Display -->
                    <div id="subjectDetailsTabContent" class="tab-content active">
                        <!-- Subject Info Summary - Basic Subject Information -->
                        <div class="subject-info-summary" id="subjectInfoSummary">
                            <!-- Subject information will be loaded here -->
                        </div>
                        
                        <!-- Subject Details Content - Statistics and Related Data -->
                        <div class="subject-details-content" id="subjectDetailsContent">
                            <!-- Subject statistics, students, evaluations, etc. will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Subject Content Tab Content - Subject Topics Management -->
                    <div id="subjectContentTabContent" class="tab-content">
                        <!-- Content Management - Subject Topics/Content Management -->
                        <div class="content-management">
                            <div class="content-header">
                                <h3 data-translate="subject_content">Contenido de la Materia</h3>
                                <button id="addContentBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i>
                                    <span data-translate="add_content">Agregar Contenido</span>
                                </button>
                            </div>
                            <!-- Content List Container - List of Subject Topics -->
                            <div class="content-list-container" id="subjectContentList">
                                <!-- Content list will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===============================================================
                 MATERIA DETAILS SECTION - View Subject Themes and Evaluaciones
                 =============================================================== -->
            <!-- Materia Details Section -->
            <section id="materia-details" class="content-section">
                <div class="section-header d-flex justify-between items-center mb-8 flex-wrap gap-4">
                    <div class="d-flex items-center gap-4">
                        <button id="backToSubjectsFromDetailsBtn" class="btn-secondary px-4 py-2">
                            <i class="fas fa-arrow-left"></i>
                            <span data-translate="back">Volver</span>
                        </button>
                        <h2 id="materiaDetailsTitle" class="text-3xl font-semibold text-dark">Detalles de la Materia</h2>
                    </div>
                </div>

                <div style="padding: 1.5rem 2rem;">
                    <!-- Tab Navigation -->
                    <div class="subject-details-tabs" style="margin-bottom: 1.5rem;">
                        <button id="temasTabBtn" class="tab-btn active" data-tab="temas">
                            <i class="fas fa-book-open"></i>
                            <span data-translate="themes">Temas</span>
                        </button>
                        <button id="evaluacionesTabBtn" class="tab-btn" data-tab="evaluaciones">
                            <i class="fas fa-clipboard-list"></i>
                            <span data-translate="evaluations">Evaluaciones</span>
                        </button>
                        <button id="estudiantesTabBtn" class="tab-btn" data-tab="estudiantes">
                            <i class="fas fa-users"></i>
                            <span data-translate="students">Estudiantes</span>
                        </button>
                    </div>

                    <!-- Temas Tab Content -->
                    <div id="temasTabContent" class="tab-content active">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; background: transparent;">
                            <h3 style="margin: 0; color: var(--text-primary, #333); font-size: 1.2rem;">
                                <i class="fas fa-book-open" style="margin-right: 8px;"></i>
                                Temas de la Materia
                            </h3>
                            <div style="display: flex; gap: 8px;">
                                <button id="importTemasBtn" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-upload"></i> Importar Excel
                                </button>
                                <button id="showCreateThemeFormBtn" class="btn-primary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-plus"></i> Crear Tema
                                </button>
                            </div>
                        </div>
                        <div id="subjectThemesList" style="max-height: 500px; overflow-y: auto; background: var(--card-bg, #fff); border-radius: 8px; padding: 1rem;">
                            <!-- Temas will be loaded here -->
                        </div>

                        <!-- Create Theme Form View - Form to Create New Theme -->
                        <div id="createThemeFormView" style="display: none; margin-top: 2rem; background: var(--card-bg, #fff); border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h4 style="margin: 0; color: var(--text-primary, #333);">Crear Nuevo Tema</h4>
                                <button id="backToThemesListBtn" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-arrow-left"></i> Volver
                                </button>
                            </div>
                            <form id="unifiedContentForm">
                                <input type="hidden" id="unifiedContentSubjectId" value="">
                                <div class="form-group">
                                    <label for="unifiedContentTopic" data-translate="topic">Tema</label>
                                    <input type="text" id="unifiedContentTopic" required>
                                </div>
                                <div class="form-group">
                                    <label for="unifiedContentDescription" data-translate="description">Descripci贸n</label>
                                    <textarea id="unifiedContentDescription" rows="3" placeholder="Descripci贸n del tema..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="unifiedContentStatus" data-translate="status">Estado</label>
                                    <select id="unifiedContentStatus">
                                        <option value="PENDIENTE" data-translate="pending">Pendiente</option>
                                        <option value="EN_PROGRESO" data-translate="in_progress">En Progreso</option>
                                        <option value="COMPLETADO" data-translate="completed">Completado</option>
                                        <option value="CANCELADO" data-translate="cancelled">Cancelado</option>
                                    </select>
                                </div>
                                <div class="form-actions">
                                    <button type="button" id="cancelCreateThemeBtn" class="btn-secondary" data-translate="cancel">Cancelar</button>
                                    <button type="submit" class="btn-primary" data-translate="save_content">Guardar Tema</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Evaluaciones Tab Content -->
                    <div id="evaluacionesTabContent" class="tab-content" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="margin: 0; color: var(--text-primary, #333); font-size: 1.2rem;">
                                <i class="fas fa-clipboard-list" style="margin-right: 8px;"></i>
                                Evaluaciones
                            </h3>
                            <div style="display: flex; gap: 8px;">
                                <button id="importEvaluacionesBtn" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-upload"></i> Importar Excel
                                </button>
                                <button id="showCreateEvaluacionFormBtn" class="btn-primary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-plus"></i> Crear Evaluaci贸n
                                </button>
                            </div>
                        </div>
                        <div id="subjectEvaluacionesList" style="max-height: 500px; overflow-y: auto; background: var(--card-bg, #fff); border-radius: 8px; padding: 1rem;">
                            <!-- Evaluaciones will be loaded here -->
                        </div>

                        <!-- Create Evaluacion Form View -->
                        <div id="createEvaluacionFormView" style="display: none; margin-top: 2rem; background: var(--card-bg, #fff); border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h4 style="margin: 0; color: var(--text-primary, #333);">Crear Nueva Evaluaci贸n</h4>
                                <button id="backToEvaluacionesListBtn" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-arrow-left"></i> Volver
                                </button>
                            </div>
                            <form id="evaluacionForm">
                                <input type="hidden" id="evaluacionSubjectId" value="">
                                <div class="form-group">
                                    <label for="evaluacionTitulo" data-translate="title">T铆tulo</label>
                                    <input type="text" id="evaluacionTitulo" required>
                                </div>
                                <div class="form-group">
                                    <label for="evaluacionDescripcion" data-translate="description">Descripci贸n</label>
                                    <textarea id="evaluacionDescripcion" rows="3" placeholder="Descripci贸n de la evaluaci贸n..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="evaluacionFecha" data-translate="date">Fecha</label>
                                    <input type="date" id="evaluacionFecha" required>
                                </div>
                                <div class="form-group">
                                    <label for="evaluacionTipo" data-translate="type">Tipo</label>
                                    <select id="evaluacionTipo" required>
                                        <option value="EXAMEN" data-translate="exam">Examen</option>
                                        <option value="PARCIAL" data-translate="partial">Parcial</option>
                                        <option value="TRABAJO_PRACTICO" data-translate="practical_work">Trabajo Pr谩ctico</option>
                                        <option value="PROYECTO" data-translate="project">Proyecto</option>
                                        <option value="ORAL" data-translate="oral">Oral</option>
                                        <option value="PRACTICO" data-translate="practical">Pr谩ctico</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="evaluacionPeso" data-translate="weight">Peso</label>
                                    <input type="number" id="evaluacionPeso" min="0" max="9.99" step="0.01" value="1.00" required>
                                </div>
                                <div class="form-group">
                                    <label for="evaluacionEstado" data-translate="status">Estado</label>
                                    <select id="evaluacionEstado">
                                        <option value="PROGRAMADA" data-translate="scheduled">Programada</option>
                                        <option value="EN_CURSO" data-translate="in_progress">En Curso</option>
                                        <option value="FINALIZADA" data-translate="finished">Finalizada</option>
                                        <option value="CANCELADA" data-translate="cancelled">Cancelada</option>
                                    </select>
                                </div>
                                <div class="form-actions">
                                    <button type="button" id="cancelCreateEvaluacionBtn" class="btn-secondary" data-translate="cancel">Cancelar</button>
                                    <button type="submit" class="btn-primary" data-translate="save">Guardar Evaluaci贸n</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Estudiantes Tab Content -->
                    <div id="estudiantesTabContent" class="tab-content" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="margin: 0; color: var(--text-primary, #333); font-size: 1.2rem;">
                                <i class="fas fa-users" style="margin-right: 8px;"></i>
                                Estudiantes Inscritos
                            </h3>
                            <div style="display: flex; gap: 8px;">
                                <button id="importEstudiantesBtn" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-upload"></i> Importar Excel
                                </button>
                                <button id="addStudentToMateriaBtn" class="btn-primary" style="padding: 8px 16px; font-size: 0.9em;">
                                    <i class="fas fa-plus"></i> Agregar Estudiante
                                </button>
                            </div>
                        </div>
                        <!-- Student Cards View -->
                        <div id="materiaStudentsCards" style="display: none;">
                            <!-- Student cards will be loaded here -->
                        </div>
                        <!-- Student List View -->
                        <div id="materiaStudentsList" style="max-height: 500px; overflow-y: auto; background: var(--card-bg, #fff); border-radius: 8px; padding: 1rem;">
                            <!-- Student list will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            


        </main>
    </div>

    <!-- ===================================================================
         FOOTER SECTION - Desktop Footer with Links and Copyright
         =================================================================== -->
    <!-- Footer (Desktop Only) -->
    <footer class="footer desktop-only">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <img src="../styles/assets/icon.ico" alt="EduSync" style="width:20px;height:20px;">
                    <span>EduSync</span>
                </div>
                <div class="footer-links">
                    <a href="#features" data-translate="features">Features</a>
                    <a href="#about" data-translate="about">About</a>
                    <a href="contact.html" data-translate="contact">Contact</a>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2024 EduSync. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- ===================================================================
         MODALS SECTION - All Application Modal Dialogs
         =================================================================== -->
    
    <!-- Student Modal - Add/Edit Student -->
    <div id="studentModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="add_edit_student">Agregar/Editar Estudiante</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="studentForm" class="modal-dialog-body">
                <div class="form-group">
                    <label for="studentFirstName" data-translate="first_name">Nombre</label>
                    <input type="text" id="studentFirstName" required>
                </div>
                <div class="form-group">
                    <label for="studentLastName" data-translate="last_name">Apellido</label>
                    <input type="text" id="studentLastName" required>
                </div>
                <div class="form-group">
                    <label for="studentEmail" data-translate="email">Correo Electr贸nico</label>
                    <input type="email" id="studentEmail" required>
                </div>
                <div class="form-group">
                    <label for="studentCourse" data-translate="course">Curso</label>
                    <select id="studentCourse">
                        <option value="" data-translate="select_course">- Seleccionar Curso (Opcional) -</option>
                        <!-- Se poblar谩 din谩micamente con los cursos disponibles -->
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">Si seleccionas un curso, se asignar谩n autom谩ticamente todas las materias de ese curso.</small>
                </div>
                <div class="form-group">
                    <label for="studentSubjects" data-translate="subjects">Materias</label>
                    <select id="studentSubjects" required>
                        <option value="" data-translate="select_subject">- Seleccionar Materia -</option>
                        <!-- Se poblar谩 din谩micamente con las materias del docente actual -->
                    </select>
                    <div id="selectedSubjectsContainer" class="selected-subjects-container" style="display: none; margin-top: 10px;">
                        <!-- Selected subjects will be displayed here as chips -->
                    </div>
                    <small style="display: block; margin-top: 5px; color: #666;">Puedes seleccionar m煤ltiples materias individualmente o seleccionar un curso arriba para asignar todas las materias del curso.</small>
                </div>
                <div class="form-group">
                    <label for="studentStatus" data-translate="status">Estado</label>
                    <select id="studentStatus" required onchange="toggleIntensificacionThemes()">
                        <option value="ACTIVO" data-translate="active">Activo</option>
                        <option value="INACTIVO" data-translate="inactive">Inactivo</option>
                        <option value="INTENSIFICA" data-translate="intensifica">Intensifica</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">Los estudiantes en Intensifica aparecer谩n destacados y ver谩n temas de recuperaci贸n.</small>
                </div>
                <!-- Selector de temas para intensificadores - Intensification Theme Selector -->
                <div id="intensificacionThemesContainer" class="form-group" style="display: none;">
                    <label data-translate="themes_to_intensify">Temas a Intensificar</label>
                    <div style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px; background: #f9f9f9;">
                        <div id="intensificacionThemesList">
                            <!-- Los temas se cargar谩n din谩micamente -->
                        </div>
                    </div>
                    <small style="display: block; margin-top: 5px; color: #666;">Los temas mostrados corresponden a las materias seleccionadas arriba. Si una materia no tiene temas, puedes crearlos directamente desde aqu铆.</small>
                </div>
                <!-- Selector de temas para asignar al estudiante - Assign Topics to Student -->
                <div class="form-group">
                    <label for="studentTopics" data-translate="assign_topics">Asignar Temas</label>
                    <select id="studentTopics">
                        <option value="" data-translate="select_topic">- Seleccionar Tema -</option>
                        <!-- Se poblar谩 din谩micamente con los temas de las materias seleccionadas -->
                    </select>
                    <div id="selectedTopicsContainer" class="selected-subjects-container" style="display: none; margin-top: 10px;">
                        <!-- Selected topics will be displayed here as chips -->
                    </div>
                    <small style="display: block; margin-top: 5px; color: #666;">Selecciona temas espec铆ficos para asignar al estudiante. Los temas disponibles corresponden a las materias seleccionadas arriba.</small>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="button" class="btn-primary" data-translate="save_student" onclick="saveStudent(); event.preventDefault(); return false;">Guardar Estudiante</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Load Course Division Modal - Bulk Student Import -->
    <div id="loadCourseDivisionModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3>Cargar Curso/Divisi贸n</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="loadCourseDivisionForm" class="modal-dialog-body">
                <div class="form-group">
                    <label for="bulkCourseDivision">Curso y Divisi贸n</label>
                    <select id="bulkCourseDivision" required>
                        <option value="">- Seleccionar Curso -</option>
                        <!-- Se poblar谩 din谩micamente con los cursos disponibles -->
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">Selecciona un curso existente o elige "+ Crear Nuevo Curso".</small>
                </div>
                <div id="bulkCreateNewCourseSection" class="form-group" style="display:none; background: #f5f5f5; padding: 12px; border-radius: 8px;">
                    <label>Crear nuevo Curso/Divisi贸n</label>
                    <div style="display:flex; gap:8px; flex-wrap:wrap;">
                        <select id="bulkCourseNumber" style="flex:1; min-width:140px;">
                            <option value="">- Curso -</option>
                            <option value="1">1潞</option>
                            <option value="2">2潞</option>
                            <option value="3">3潞</option>
                            <option value="4">4潞</option>
                            <option value="5">5潞</option>
                            <option value="6">6潞</option>
                            <option value="7">7潞</option>
                        </select>
                        <select id="bulkDivisionLetter" style="flex:1; min-width:140px;">
                            <option value="">- Divisi贸n -</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                        </select>
                    </div>
                    <small style="display:block; margin-top:6px; color:#666;">Se crear谩 como: <strong>CURSO潞 Curso - Divisi贸n X</strong>.</small>
                </div>
                <div class="form-group">
                    <label for="bulkStudentsList">Lista de Alumnos</label>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <button type="button" class="btn-secondary" id="toggleInputModeBtn" onclick="toggleBulkInputMode(); return false;">
                            <i class="fas fa-table"></i> Modo Tabla Manual
                        </button>
                    </div>
                    <div id="bulkTextareaMode">
                        <div id="bulkCsvUploadArea" style="border: none; border-radius: 8px; padding: 40px; text-align: center; background: transparent; transition: all 0.3s ease; cursor: pointer; position: relative;">
                            <input type="file" id="bulkStudentsFileInput" accept=".csv" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0; cursor: pointer; z-index: 1;">
                            <div id="bulkCsvUploadContent">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #667eea; margin-bottom: 16px;"></i>
                                <p style="margin: 0; font-size: 16px; color: #333; font-weight: 500;">
                                    Arrastra y suelta tu archivo CSV aqu铆
                                </p>
                                <p style="margin: 8px 0 0 0; font-size: 14px; color: #666;">
                                    o haz clic para seleccionar
                                </p>
                                <small style="display: block; margin-top: 12px; color: #999;">
                                    Formato: .csv (exporta desde Excel como CSV)
                                </small>
                            </div>
                            <div id="bulkCsvFileInfo" style="display: none; padding: 16px; background: transparent; border-radius: 6px; margin-top: 16px; text-align: left;">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <i class="fas fa-file-csv" style="font-size: 24px; color: #667eea;"></i>
                                        <div>
                                            <p style="margin: 0; font-weight: 500; color: #333;" id="bulkCsvFileName">archivo.csv</p>
                                            <small style="color: #666;" id="bulkCsvFileSize">0 KB</small>
                                        </div>
                                    </div>
                                    <button type="button" id="bulkCsvRemoveFile" class="btn-icon btn-secondary" style="padding: 6px;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="bulkCsvPreview" style="display: none; margin-top: 16px; padding: 16px; background: transparent; border-radius: 6px; border: none;">
                            <h4 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600; color: #333;">Vista Previa:</h4>
                            <div id="bulkCsvPreviewContent" style="max-height: 200px; overflow-y: auto;"></div>
                            <p style="margin: 12px 0 0 0; color: #666; font-weight: 600; font-size: 14px;" id="bulkCsvPreviewTotal">Total: 0 estudiante(s)</p>
                        </div>
                        <small style="display: block; margin-top: 8px; color: #666;">
                            Formato esperado: Nombre, Apellido (o Apellido, Nombre). El archivo debe tener encabezados en la primera fila.
                        </small>
                    </div>
                    <div id="bulkTableMode" style="display:none;">
                        <div style="background: #f9f9f9; padding: 12px; border-radius: 6px; border: 1px solid #ddd;">
                            <table class="data-table" style="width: 100%; margin-bottom: 10px;">
                                <thead>
                                    <tr>
                                        <th>Apellido</th>
                                        <th>Nombre</th>
                                        <th style="width: 80px;">Acci贸n</th>
                                    </tr>
                                </thead>
                                <tbody id="bulkManualStudentsTableBody">
                                    <tr>
                                        <td><input type="text" id="manualApellido_0" class="manual-student-input" placeholder="Apellido" style="width: 100%; padding: 6px;"></td>
                                        <td><input type="text" id="manualNombre_0" class="manual-student-input" placeholder="Nombre" style="width: 100%; padding: 6px;"></td>
                                        <td>
                                            <button type="button" class="btn-icon btn-primary" onclick="addManualStudentRow(); return false;" title="Agregar siguiente alumno">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <small style="color: #666;">Presiona Enter en el campo Nombre para agregar el siguiente alumno.</small>
                                <button type="button" class="btn-secondary" onclick="removeLastManualStudentRow(); return false;">
                                    <i class="fas fa-trash"></i> Eliminar ltimo
                                </button>
                            </div>
                        </div>
                        <small style="display: block; margin-top: 5px; color: #666;">
                            Ingresa los alumnos uno por uno. Usa el bot贸n + o Enter para agregar el siguiente.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label for="bulkStudentStatus">Estado por Defecto</label>
                    <select id="bulkStudentStatus">
                        <option value="ACTIVO">Activo</option>
                        <option value="INACTIVO">Inactivo</option>
                        <option value="INTENSIFICA">Intensifica</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">Estado que se asignar谩 a todos los alumnos cargados.</small>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="button" class="btn-primary" onclick="processBulkStudents(); return false;">Cargar Alumnos</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Subject Modal - Add/Edit Subject -->
    <!-- Course Management Modal -->
    <div id="courseModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 id="courseModalTitle">Agregar Curso</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="courseForm" class="modal-dialog-body">
                <input type="hidden" id="courseId" value="">
                <div class="form-group">
                    <label for="courseNumber">Curso</label>
                    <select id="courseNumber" required>
                        <option value="">- Seleccionar Curso -</option>
                        <option value="1">1潞</option>
                        <option value="2">2潞</option>
                        <option value="3">3潞</option>
                        <option value="4">4潞</option>
                        <option value="5">5潞</option>
                        <option value="6">6潞</option>
                        <option value="7">7潞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="courseDivision">Divisi贸n</label>
                    <select id="courseDivision" required>
                        <option value="">- Seleccionar Divisi贸n -</option>
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="courseInstitucion">Instituci贸n</label>
                    <input type="text" id="courseInstitucion" placeholder="Ej: Escuela Secundaria N掳1" required>
                    <small style="display: block; margin-top: 5px; color: #666;">
                        El mismo curso puede repetirse en distintas instituciones.
                    </small>
                </div>
                <div class="form-group">
                    <label for="courseStatus">Estado</label>
                    <select id="courseStatus">
                        <option value="ACTIVO">Activo</option>
                        <option value="INACTIVO">Inactivo</option>
                    </select>
                </div>
                <div class="form-group">
                    <small style="display: block; margin-top: 5px; color: #666;">
                        Se crear谩 como: <strong id="coursePreview">-</strong>
                    </small>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="button" class="btn-primary" onclick="saveCourse(); event.preventDefault(); return false;">Guardar Curso</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <div id="subjectModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="add_edit_subject">Agregar/Editar Materia</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="subjectForm" class="modal-dialog-body">
                <div class="form-group">
                    <label for="subjectName" data-translate="subject_name">Nombre de la Materia</label>
                    <input type="text" id="subjectName" required>
                </div>
                <div class="form-group">
                    <label for="subjectCourseDivision" data-translate="course_division">Curso</label>
                    <select id="subjectCourseDivision" required>
                        <option value="" data-translate="select_course">- Seleccionar Curso -</option>
                        <!-- Se poblar谩 din谩micamente con cursos existentes -->
                    </select>
                    <small style="display: block; margin-top: 5px; color: #666;">
                        Selecciona un curso existente o crea uno nuevo. Los cursos se cargan desde las materias creadas.
                    </small>
                </div>
                <!-- Secci贸n para crear nuevo curso (oculta por defecto) -->
                <div id="createNewCourseSection" style="display: none; padding: 15px; border-radius: 6px; margin-top: 10px;border:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="subjectCourse" data-translate="course">Curso</label>
                            <select id="subjectCourse">
                                <option value="" data-translate="select_course">- Seleccionar Curso -</option>
                                <option value="1">1潞 Curso</option>
                                <option value="2">2潞 Curso</option>
                                <option value="3">3潞 Curso</option>
                                <option value="4">4潞 Curso</option>
                                <option value="5">5潞 Curso</option>
                                <option value="6">6潞 Curso</option>
                                <option value="7">7潞 Curso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subjectDivision" data-translate="division">Divisi贸n</label>
                            <select id="subjectDivision">
                                <option value="" data-translate="select_division">- Seleccionar Divisi贸n -</option>
                                <option value="A">Divisi贸n A</option>
                                <option value="B">Divisi贸n B</option>
                                <option value="C">Divisi贸n C</option>
                                <option value="D">Divisi贸n D</option>
                                <option value="E">Divisi贸n E</option>
                                <option value="F">Divisi贸n F</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subjectInstitucion">Instituci贸n</label>
                            <input type="text" id="subjectInstitucion" placeholder="Ej: Escuela Secundaria N掳1">
                            <small style="display: block; margin-top: 5px; color: #666;">
                                El mismo curso puede repetirse en distintas instituciones.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="subjectDescription" data-translate="description">Descripci贸n</label>
                    <textarea id="subjectDescription" rows="3" placeholder="Descripci贸n de la materia..."></textarea>
                </div>
                <!-- Schedule Selector - Subject Schedule Configuration -->
                <div class="form-group">
                    <label data-translate="schedule">Horario</label>
                    <div class="schedule-selector">
                        <!-- Schedule Entries Container -->
                        <div id="scheduleEntriesContainer">
                            <!-- Schedule entries will be dynamically added here -->
                        </div>
                        
                        <!-- Add New Schedule Entry Button -->
                        <button type="button" id="addScheduleEntryBtn" class="btn btn-primary" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Agregar Horario
                        </button>
                        
                        <input type="hidden" id="subjectSchedule" name="subjectSchedule">
                    </div>
                </div>
                <div class="form-group">
                    <label for="subjectClassroom" data-translate="classroom">Aula</label>
                    <input type="number" id="subjectClassroom" placeholder="Ej: 101" min="1" step="1">
                </div>
                <div class="form-group">
                    <label for="subjectStatus" data-translate="status">Estado</label>
                    <select id="subjectStatus">
                        <option value="ACTIVA" data-translate="active">Activa</option>
                        <option value="INACTIVA" data-translate="inactive">Inactiva</option>
                        <option value="FINALIZADA" data-translate="finished">Finalizada</option>
                    </select>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="submit" class="btn-primary" data-translate="save_subject">Guardar Materia</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Content Modal - Create/Edit Content/Topic -->
    <div id="contentModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="add_edit_content">Agregar/Editar Contenido</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="contentForm" class="modal-dialog-body">
                <div class="form-group">
                    <label for="contentSubject" data-translate="subject">Materia</label>
                    <select id="contentSubject" required>
                        <option value="" data-translate="select_subject">- Seleccionar Materia -</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="contentTopic" data-translate="topic">Tema</label>
                    <input type="text" id="contentTopic" required>
                </div>
                <div class="form-group">
                    <label for="contentDescription" data-translate="description">Descripci贸n</label>
                    <textarea id="contentDescription" rows="3" placeholder="Descripci贸n del tema..."></textarea>
                </div>
                <div class="form-group">
                    <label for="contentStatus" data-translate="status">Estado</label>
                    <select id="contentStatus">
                        <option value="PENDIENTE" data-translate="pending">Pendiente</option>
                        <option value="EN_PROGRESO" data-translate="in_progress">En Progreso</option>
                        <option value="COMPLETADO" data-translate="completed">Completado</option>
                        <option value="CANCELADO" data-translate="cancelled">Cancelado</option>
                    </select>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="submit" class="btn-primary" data-translate="save_content">Guardar Contenido</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Subject Themes Modal - View and Manage Subject Themes -->
    <div id="subjectThemesModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 id="selectedSubjectName">Nombre de la Materia</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                    <!-- Themes List View - Display All Subject Themes -->
                    <div id="themesListView">
                        <div class="d-flex justify-between items-center mb-4">
                            <div class="text-sm font-semibold text-secondary">Temas de la Materia</div>
                            <button id="showCreateThemeFormBtn" class="btn-primary px-4 py-2 text-sm">
                                <i class="fas fa-plus"></i> Crear Tema
                            </button>
                        </div>
                        <div id="subjectThemesList" class="max-h-96 overflow-y-auto">
                            <!-- Temas will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Create Theme Form View - Form to Create New Theme -->
                    <div id="createThemeFormView" class="d-none">
                        <div class="d-flex justify-between items-center mb-4">
                            <h4 class="text-lg font-semibold text-dark m-0">Crear Nuevo Tema</h4>
                            <button id="backToThemesListBtn" class="btn-secondary px-4 py-2 text-sm">
                                <i class="fas fa-arrow-left"></i> Volver
                            </button>
                        </div>
                        <form id="unifiedContentForm">
                            <input type="hidden" id="unifiedContentSubjectId" value="">
                            <div class="form-group">
                                <label for="unifiedContentTopic" data-translate="topic">Tema</label>
                                <input type="text" id="unifiedContentTopic" required>
                            </div>
                            <div class="form-group">
                                <label for="unifiedContentDescription" data-translate="description">Descripci贸n</label>
                                <textarea id="unifiedContentDescription" rows="3" placeholder="Descripci贸n del tema..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="unifiedContentStatus" data-translate="status">Estado</label>
                                <select id="unifiedContentStatus">
                                    <option value="PENDIENTE" data-translate="pending">Pendiente</option>
                                    <option value="EN_PROGRESO" data-translate="in_progress">En Progreso</option>
                                    <option value="COMPLETADO" data-translate="completed">Completado</option>
                                    <option value="CANCELADO" data-translate="cancelled">Cancelado</option>
                                </select>
                            </div>
                            <div class="modal-dialog-footer">
                                <button type="button" id="cancelCreateThemeBtn" class="btn-secondary" data-translate="cancel">Cancelar</button>
                                <button type="submit" class="btn-primary" data-translate="save_content">Guardar Tema</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Edit Modal - Edit Existing Content -->
    <div id="contentEditModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="edit_content">Editar Contenido</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <form id="contentEditForm" class="modal-dialog-body">
                <div class="form-group">
                    <label for="editContentTopic" data-translate="content_topic">Tema del Contenido</label>
                    <input type="text" id="editContentTopic" required>
                </div>
                <div class="form-group">
                    <label for="editContentDescription" data-translate="description">Descripci贸n</label>
                    <textarea id="editContentDescription" rows="3" placeholder="Descripci贸n del contenido..."></textarea>
                </div>
                <div class="form-group">
                    <label for="editContentStatus" data-translate="status">Estado</label>
                    <select id="editContentStatus" required>
                        <option value="PENDIENTE" data-translate="pending">Pendiente</option>
                        <option value="EN_PROGRESO" data-translate="in_progress">En Progreso</option>
                        <option value="COMPLETADO" data-translate="completed">Completado</option>
                        <option value="CANCELADO" data-translate="cancelled">Cancelado</option>
                    </select>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                    <button type="submit" class="btn-primary" data-translate="save_content">Guardar Contenido</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- No Subjects Warning Modal - Warn User When No Subjects Exist -->
    <div id="noSubjectsModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3><i class="fas fa-exclamation-triangle text-warning mr-2"></i> Materias Requeridas</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body text-center">
                    <div class="text-5xl text-warning mb-4">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <p class="text-lg text-dark mb-2">
                        No tienes materias creadas todav铆a.
                    </p>
                    <p class="text-secondary mb-6">
                        Para agregar estudiantes, primero necesitas crear al menos una materia desde la secci贸n de <strong>"Gesti贸n de Materias"</strong>.
                    </p>
                    <div class="modal-dialog-footer">
                        <button type="button" class="btn-secondary close-modal" data-translate="cancel">Cancelar</button>
                        <button type="button" class="btn-primary" id="goToSubjectsBtn">
                            <i class="fas fa-book"></i>
                            <span>Ir a Gesti贸n de Materias</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Filters Modal - Configure Search Filters -->
    <div id="searchFiltersModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="search_filters">Filtros de B煤squeda</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
            <div class="modal-form">
                <div class="filter-options">
                    <div class="filter-option-group">
                        <h4 data-translate="search_in">Buscar en:</h4>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="students" checked>
                            <span class="toggle-label" data-translate="students">Estudiantes</span>
                        </label>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="subjects" checked>
                            <span class="toggle-label" data-translate="subjects">Materias</span>
                        </label>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="exams" checked>
                            <span class="toggle-label" data-translate="exams">Ex谩menes</span>
                        </label>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="notifications" checked>
                            <span class="toggle-label" data-translate="notifications">Notificaciones</span>
                        </label>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="reports" checked>
                            <span class="toggle-label" data-translate="reports">Reportes</span>
                        </label>
                        <label class="filter-toggle">
                            <input type="checkbox" class="filter-checkbox" data-filter="calendar" checked>
                            <span class="toggle-label" data-translate="calendar">Calendario</span>
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="resetFiltersBtn" data-translate="reset_filters">Restablecer</button>
                    <button type="button" class="btn-primary close-modal" data-translate="apply_filters">Aplicar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Details Modal - View Calendar Event Details -->
    <div id="eventDetailsModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header" id="eventModalHeader">
                    <h3 id="eventModalTitle">Detalles del Evento</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body" id="eventModalBody">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-primary rounded-full d-flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-calendar-day text-white text-2xl" id="eventModalIcon"></i>
                        </div>
                        <p class="text-secondary" id="eventModalSubtitle">Informaci贸n del evento</p>
                    </div>
                    <!-- Event details will be populated here -->
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-primary close-modal w-full">
                        <i class="fas fa-check"></i>
                        <span>Cerrar</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Dialog Modal - Export Students or Exams List -->
    <div id="exportDialogModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 data-translate="export_list">Exportar Lista</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                    <p class="mb-6 text-secondary" id="exportDialogText">
                        <span data-translate="select_export_format">Seleccione el formato de exportaci贸n:</span>
                    </p>
                    <div class="d-flex flex-column gap-4">
                        <button id="exportExcelBtn" class="btn-primary w-full justify-center">
                            <i class="fas fa-file-excel"></i>
                            <span>Exportar como Excel</span>
                        </button>
                        <button id="exportDOCBtn" class="btn-primary w-full justify-center">
                            <i class="fas fa-file-word"></i>
                            <span data-translate="export_doc">Exportar como DOC</span>
                        </button>
                    </div>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal w-full">
                        <i class="fas fa-times"></i>
                        <span data-translate="cancel">Cancelar</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Excel Modals -->
    <!-- Import Temas Excel Modal -->
    <div id="importTemasModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3>Importar Temas desde Excel</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                <div class="form-group">
                    <label style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Seleccionar archivo Excel (.csv o .xlsx)</span>
                        <button type="button" id="downloadTemasExampleBtn" class="btn-secondary" style="padding: 6px 12px; font-size: 0.85em;">
                            <i class="fas fa-file-excel"></i> Descargar Ejemplo
                        </button>
                    </label>
                    <input type="file" id="importTemasFile" accept=".csv,.xlsx" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100%; margin-top: 8px;">
                    <small style="display: block; margin-top: 8px; color: #666;">
                        Formato esperado: Tema, Descripci贸n, Estado<br>
                        Ejemplo: Introducci贸n a la Programaci贸n, Conceptos b谩sicos de programaci贸n, PENDIENTE<br>
                        <strong>Nota:</strong> Puedes usar archivos CSV exportados desde Excel
                    </small>
                </div>
                    <div id="importTemasPreview" class="mt-4 p-4 bg-light rounded" style="display: none;">
                        <h4 class="mb-2">Vista Previa:</h4>
                        <div id="importTemasPreviewContent" class="max-h-50 overflow-y-auto"></div>
                    </div>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="button" id="confirmImportTemasBtn" class="btn-primary">Importar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Evaluaciones CSV Modal -->
    <div id="importEvaluacionesModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3>Importar Evaluaciones desde Excel</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                <div class="form-group">
                    <label style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Seleccionar archivo Excel</span>
                        <button type="button" id="downloadEvaluacionesExampleBtn" class="btn-secondary" style="padding: 6px 12px; font-size: 0.85em;">
                            <i class="fas fa-file-excel"></i> Descargar Ejemplo
                        </button>
                    </label>
                    <input type="file" id="importEvaluacionesFile" accept=".csv,.xlsx" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100%; margin-top: 8px;">
                    <small style="display: block; margin-top: 8px; color: #666;">
                        Formato esperado: T铆tulo, Descripci贸n, Fecha (YYYY-MM-DD), Tipo, Peso, Estado<br>
                        Ejemplo: Parcial 1, Primer parcial del a帽o, 2024-03-15, PARCIAL, 1.0, PROGRAMADA<br>
                        <strong>Nota:</strong> Puedes usar archivos CSV exportados desde Excel
                    </small>
                </div>
                    <div id="importEvaluacionesPreview" class="mt-4 p-4 bg-light rounded" style="display: none;">
                        <h4 class="mb-2">Vista Previa:</h4>
                        <div id="importEvaluacionesPreviewContent" class="max-h-50 overflow-y-auto"></div>
                    </div>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="button" id="confirmImportEvaluacionesBtn" class="btn-primary">Importar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Estudiantes Excel Modal -->
    <div id="importEstudiantesModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3>Importar Estudiantes desde Excel</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                <div class="form-group">
                    <label style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Seleccionar archivo Excel (.csv o .xlsx)</span>
                        <button type="button" id="downloadEstudiantesExampleBtn" class="btn-secondary" style="padding: 6px 12px; font-size: 0.85em;">
                            <i class="fas fa-file-excel"></i> Descargar Ejemplo
                        </button>
                    </label>
                    <input type="file" id="importEstudiantesFile" accept=".csv,.xlsx" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100%; margin-top: 8px;">
                    <small style="display: block; margin-top: 8px; color: #666;">
                        Formato esperado: Nombre, Apellido, Email (opcional), Estado<br>
                        Ejemplo: Juan, P茅rez, juan.perez@email.com, ACTIVO<br>
                        <strong>Nota:</strong> Puedes usar archivos CSV exportados desde Excel
                    </small>
                </div>
                    <div id="importEstudiantesPreview" class="mt-4 p-4 bg-light rounded" style="display: none;">
                        <h4 class="mb-2">Vista Previa:</h4>
                        <div id="importEstudiantesPreviewContent" class="max-h-50 overflow-y-auto"></div>
                    </div>
                </div>
                <div class="modal-dialog-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="button" id="confirmImportEstudiantesBtn" class="btn-primary">Importar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Details Modal - View Detailed Student Information -->
    <div id="studentDetailsModal" class="modal-overlay">
        <div class="modal-dialog">
            <div class="modal-dialog-content">
                <div class="modal-dialog-header">
                    <h3 id="studentDetailsModalTitle">Detalles del Estudiante</h3>
                    <button class="modal-dialog-close close-modal">&times;</button>
                </div>
                <div class="modal-dialog-body">
                <!-- Student Basic Information - Personal Details -->
                <div class="student-details-section" style="margin-bottom: 2rem;">
                    <h4 style="margin-bottom: 1rem; color: #667eea; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-user"></i>
                        Informaci贸n del Estudiante
                    </h4>
                    <div id="studentDetailsInfo" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <!-- Student info will be populated here -->
                    </div>
                </div>

                <!-- Tema Estudiante Section - Student Topic Progress -->
                <div class="student-details-section">
                    <h4 style="margin-bottom: 1rem; color: #667eea; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-book"></i>
                        Temas del Estudiante
                    </h4>
                    <div id="studentTemaEstudianteList" style="max-height: 400px; overflow-y: auto;">
                        <!-- Tema estudiante records will be populated here -->
                    </div>
                </div>
            </div>
            <div class="form-actions" style="padding: 1rem 2rem; border-top: 1px solid #e0e0e0;">
                <button type="button" class="btn-primary close-modal" style="width: 100%;">
                    <i class="fas fa-check"></i>
                    <span>Cerrar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================================================
         SCRIPTS SECTION - JavaScript Modules and Dependencies
         =================================================================== -->
    <!-- Script Modules -->
    <script src="../scripts/translations.js"></script>
    <script src="../scripts/utils.js"></script>
    <script src="../scripts/modal-helper.js"></script>
    <script src="../scripts/navigation.js"></script>
    <script src="../scripts/search.js"></script>
    <script src="../scripts/auth.js"></script>
    <script src="../scripts/dashboard.js"></script>
    <!-- Student Management Modules (Load in order) -->
    <script src="../scripts/students/state.js"></script>
    <script src="../scripts/students/course-selector.js"></script>
    <script src="../scripts/students/subject-selector.js"></script>
    <script src="../scripts/students/topic-selector.js"></script>
    <script src="../scripts/students/intensificacion.js"></script>
    <script src="../scripts/students/crud.js"></script>
    <script src="../scripts/students/form.js"></script>
    <script src="../scripts/students/modals.js"></script>
    <script src="../scripts/students/index.js"></script>
    <script src="../scripts/students.js"></script>
    <script src="../scripts/courses.js"></script>
    <script src="../scripts/subjects.js"></script>
    <script src="../scripts/grades.js"></script>
    <script src="../scripts/attendance.js"></script>
    <script src="../scripts/unified-student-management.js"></script>
    <script src="../scripts/exams.js"></script>
    <script src="../scripts/notifications.js"></script>
    
    <!-- Report System Components (Load in order) -->
    <script src="../scripts/reports/data-processor.js"></script>
    <script src="../scripts/reports/chart-manager.js"></script>
    <script src="../scripts/reports/report-generator.js"></script>
    <script src="../scripts/reports/export-manager.js"></script>
    <script src="../scripts/reports.js"></script>
    <script src="../scripts/reports/index.js"></script>
    <script src="../scripts/calendar.js"></script>
    <script src="../scripts/main.js"></script>
</body>
</html>
